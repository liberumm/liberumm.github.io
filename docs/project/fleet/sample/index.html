<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>管理アプリケーション</title>
    <link href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/fullcalendar/3.10.2/fullcalendar.min.css" rel="stylesheet">
    <style>
        .sidebar {
            width: 250px;
            background-color: #343a40;
            color: #fff;
            padding: 20px;
            height: 100vh;
            position: fixed;
            z-index: 1000;
        }
        .sidebar h2 {
            margin-top: 0;
        }
        .sidebar ul {
            list-style-type: none;
            padding: 0;
        }
        .sidebar ul li {
            padding: 10px 0;
            cursor: pointer;
        }
        .sidebar ul li.active {
            background-color: #495057;
        }
        .sidebar .app-download {
            background-color: #007bff;
            color: #fff;
            border: none;
            padding: 10px;
            margin-top: 20px;
            cursor: pointer;
            display: block;
            text-align: center;
        }
        .main-content {
            margin-left: 270px;
            flex: 1;
            padding: 20px;
            display: none;
        }
        .main-content.active {
            display: block;
        }
        .filter-tabs .nav-link.active {
            background-color: #007bff;
            color: #fff;
        }
        table th, table td {
            vertical-align: middle;
            white-space: nowrap;
        }
        .form-check-input {
            margin: 0;
        }
        .filter-section {
            display: flex;
            align-items: center;
            margin-bottom: 10px;
        }
        .filter-section .form-control {
            flex: 1;
            margin-right: 10px;
        }
        .modal-dialog {
            max-width: 500px;
        }
        #calendar {
            max-width: 900px;
            margin: 0 auto;
        }
        .table-wrapper {
            overflow-x: auto;
        }
        .table-count {
            margin-bottom: 10px;
        }
        th.sticky, td.sticky {
            position: -webkit-sticky;
            position: sticky;
            left: 0;
            background: white;
            z-index: 10;
        }
    </style>
</head>
<body>
    <div class="d-flex">
        <div class="sidebar">
            <h2>管理</h2>
            <ul>
                <li class="nav-item" onclick="showPage(event, 'log-functions')">ログ機能</li>
                <li class="nav-item" onclick="showPage(event, 'calendar-management')">タスクスケジュール管理</li>
                <li><hr></li>
                <li class="nav-item" onclick="showPage(event, 'device-management')">デバイス管理</li>
                <li class="nav-item" onclick="showPage(event, 'group-management')">デバイスグループ管理</li>
                <li><hr></li>
                <li class="nav-item" onclick="showPage(event, 'task-management')">タスク管理</li>
                <li class="nav-item" onclick="showPage(event, 'task-group-management')">タスクグループ管理</li>
                <li><hr></li>
                <li class="nav-item" onclick="showPage(event, 'tag-device-management')">タグでデバイス管理</li>
                <li class="nav-item" onclick="showPage(event, 'tag-task-management')">タグでタスク管理</li>
                <li class="nav-item" onclick="showPage(event, 'tag-management')">タグ管理</li>
                <li><hr></li>
                <li class="nav-item" onclick="showPage(event, 'user-management')">webユーザー管理</li>
            </ul>
            <button class="app-download">アプリダウンロード</button>
        </div>
        <div class="main-content" id="log-functions">
            <h1>ログ機能</h1>
            <div class="mb-3 mt-3">
                <button class="btn btn-info" onclick="downloadCSV('logTable')">CSVダウンロード</button>
            </div>
            <div class="filter-section">
                <input type="text" id="logFilterDevice" placeholder="デバイス名フィルター" class="form-control">
                <input type="text" id="logFilterGroup" placeholder="デバイスグループフィルター" class="form-control">
                <input type="text" id="logFilterTask" placeholder="タスク名フィルター" class="form-control">
                <input type="text" id="logFilterTaskGroup" placeholder="タスクグループフィルター" class="form-control">
                <input type="text" id="logFilterStatus" placeholder="成否フィルター" class="form-control">
                <input type="text" id="logFilterLastUpdate" placeholder="最終更新時刻フィルター" class="form-control">
                <input type="text" id="logFilterNotes" placeholder="備考フィルター" class="form-control">
                <button class="btn btn-primary" onclick="filterTableByText('logTable')">適用</button>
            </div>
            <ul class="nav nav-tabs filter-tabs" id="logTabs">
                <li class="nav-item">
                    <a class="nav-link active" data-toggle="tab" href="#logAll" onclick="filterTable('logTable', '')">全て</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" data-toggle="tab" href="#logSuccess" onclick="filterTable('logTable', '成功')">成功</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" data-toggle="tab" href="#logFailure" onclick="filterTable('logTable', '失敗')">失敗</a>
                </li>
            </ul>
            <div class="table-wrapper">
                <div class="table-count">件数: <span id="logCount"></span></div>
                <table class="table table-bordered mt-3" id="logTable">
                    <thead>
                        <tr>
                            <th>デバイス名</th>
                            <th>デバイスグループ名</th>
                            <th>タスク名</th>
                            <th>タスクグループ名</th>
                            <th>タスクの成否</th>
                            <th>最終更新時刻</th>
                            <th>備考</th>
                        </tr>
                    </thead>
                    <tbody>
                        <!-- ダミーデータ -->
                        <tr>
                            <td>Device A</td>
                            <td>Group 1</td>
                            <td>Task A</td>
                            <td>Task Group A</td>
                            <td>成功</td>
                            <td>2024/06/19 10:00</td>
                            <td></td>
                        </tr>
                        <tr>
                            <td>Device B</td>
                            <td>Group 2</td>
                            <td>Task B</td>
                            <td>Task Group B</td>
                            <td>失敗</td>
                            <td>2024/06/18 14:30</td>
                            <td></td>
                        </tr>
                        <!-- ダミーデータここまで -->
                    </tbody>
                </table>
            </div>
            <nav>
                <ul class="pagination justify-content-center" id="logPagination"></ul>
            </nav>
        </div>
        <div class="main-content" id="calendar-management">
            <h1>タスクスケジュール管理</h1>
            <div class="filter-section">
                <select id="taskGroupFilterCalendar" class="form-control" onchange="filterCalendar()">
                    <option value="">全てのタスクグループ</option>
                    <option value="Task Group A">Task Group A</option>
                    <option value="Task Group B">Task Group B</option>
                </select>
            </div>
            <ul class="nav nav-tabs filter-tabs" id="calendarTabs">
                <li class="nav-item">
                    <a class="nav-link active" data-toggle="tab" href="#calendarMonth" onclick="changeView('month')">月間表示</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" data-toggle="tab" href="#calendarWeek" onclick="changeView('agendaWeek')">週間表示</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" data-toggle="tab" href="#calendarDay" onclick="changeView('agendaDay')">単日表示</a>
                </li>
            </ul>
            <div id="calendar"></div>
        </div>
        <div class="main-content" id="device-management">
            <h1>デバイス管理</h1>
            <div class="mb-3 mt-3">
                <button class="btn btn-success" onclick="addRow('deviceTable')">新規登録</button>
                <button class="btn btn-info" onclick="downloadCSV('deviceTable')">CSVダウンロード</button>
            </div>
            <div class="filter-section">
                <input type="text" id="deviceFilterNo" placeholder="Noフィルター" class="form-control">
                <input type="text" id="deviceFilterStatus" placeholder="有効無効フィルター" class="form-control">
                <input type="text" id="deviceFilterName" placeholder="デバイス名フィルター" class="form-control">
                <input type="text" id="deviceFilterHwid" placeholder="HWIDフィルター" class="form-control">
                <input type="text" id="deviceFilterUser" placeholder="ユーザーフィルター" class="form-control">
                <input type="text" id="deviceFilterPassword" placeholder="パスワードフィルター" class="form-control">
                <input type="text" id="deviceFilterGroup" placeholder="グループフィルター" class="form-control">
                <input type="text" id="deviceFilterIp" placeholder="IPアドレスフィルター" class="form-control">
                <input type="text" id="deviceFilterLastAccess" placeholder="最終アクセスフィルター" class="form-control">
                <input type="text" id="deviceFilterTags" placeholder="タグフィルター" class="form-control">
                <input type="text" id="deviceFilterNotes" placeholder="備考フィルター" class="form-control">
                <button class="btn btn-primary" onclick="filterTableByText('deviceTable')">適用</button>
            </div>
            <ul class="nav nav-tabs filter-tabs" id="deviceTabs">
                <li class="nav-item">
                    <a class="nav-link active" data-toggle="tab" href="#deviceAll" onclick="filterTable('deviceTable', '')">全て</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" data-toggle="tab" href="#deviceEnabled" onclick="filterTable('deviceTable', '有効')">有効</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" data-toggle="tab" href="#deviceDisabled" onclick="filterTable('deviceTable', '無効')">無効</a>
                </li>
            </ul>
            <div class="table-wrapper">
                <div class="table-count">件数: <span id="deviceCount"></span></div>
                <table class="table table-bordered mt-3" id="deviceTable">
                    <thead>
                        <tr>
                            <th class="sticky"><input type="checkbox" class="form-check-input"></th>
                            <th class="sticky">No</th>
                            <th class="sticky">有効無効</th>
                            <th>デバイス名</th>
                            <th>HWID</th>
                            <th>ユーザー</th>
                            <th>パスワード</th>
                            <th>グループ</th>
                            <th>IPアドレス</th>
                            <th>最終アクセス</th>
                            <th>タグ</th>
                            <th>備考</th>
                            <th>編集</th>
                            <th>削除</th>
                        </tr>
                    </thead>
                    <tbody>
                        <!-- ダミーデータ -->
                        <tr>
                            <td><input type="checkbox" class="form-check-input"></td>
                            <td>1</td>
                            <td>有効</td>
                            <td>Device A</td>
                            <td>123456</td>
                            <td>User A</td>
                            <td>password</td>
                            <td>Group 1</td>
                            <td>192.168.1.1</td>
                            <td>2024/06/19 10:00</td>
                            <td>
                                <select multiple class="form-control">
                                    <option>Tag A</option>
                                    <option>Tag B</option>
                                </select>
                            </td>
                            <td></td>
                            <td><button class="btn btn-primary">編集</button></td>
                            <td><button class="btn btn-danger" onclick="deleteRow(this)">削除</button></td>
                        </tr>
                        <tr>
                            <td><input type="checkbox" class="form-check-input"></td>
                            <td>2</td>
                            <td>無効</td>
                            <td>Device B</td>
                            <td>654321</td>
                            <td>User B</td>
                            <td>password</td>
                            <td>Group 2</td>
                            <td>192.168.1.2</td>
                            <td>2024/06/18 14:30</td>
                            <td>
                                <select multiple class="form-control">
                                    <option>Tag A</option>
                                    <option>Tag B</option>
                                </select>
                            </td>
                            <td></td>
                            <td><button class="btn btn-primary">編集</button></td>
                            <td><button class="btn btn-danger" onclick="deleteRow(this)">削除</button></td>
                        </tr>
                        <tr>
                            <td><input type="checkbox" class="form-check-input"></td>
                            <td>3</td>
                            <td>無効</td>
                            <td>Device B</td>
                            <td>654323</td>
                            <td>anonymous</td>
                            <td>password</td>
                            <td>Group 2</td>
                            <td>192.168.1.2</td>
                            <td>2024/06/18 14:30</td>
                            <td>
                                <select multiple class="form-control">
                                    <option>Tag A</option>
                                    <option>Tag B</option>
                                </select>
                            </td>
                            <td></td>
                            <td><button class="btn btn-primary">編集</button></td>
                            <td><button class="btn btn-danger" onclick="deleteRow(this)">削除</button></td>
                        </tr>
                        <!-- ダミーデータここまで -->
                    </tbody>
                </table>
            </div>
            <nav>
                <ul class="pagination justify-content-center" id="devicePagination"></ul>
            </nav>
        </div>
        <div class="main-content" id="group-management">
            <h1>デバイスグループ管理</h1>
            <div class="mb-3 mt-3">
                <button class="btn btn-success" onclick="addRow('deviceGroupTable')">新規登録</button>
                <button class="btn btn-info" onclick="downloadCSV('deviceGroupTable')">CSVダウンロード</button>
            </div>
            <div class="filter-section">
                <input type="text" id="deviceGroupFilterNo" placeholder="Noフィルター" class="form-control">
                <input type="text" id="deviceGroupFilterStatus" placeholder="有効無効フィルター" class="form-control">
                <input type="text" id="deviceGroupFilterName" placeholder="グループ名フィルター" class="form-control">
                <input type="text" id="deviceGroupFilterCount" placeholder="登録デバイス数フィルター" class="form-control">
                <input type="text" id="deviceGroupFilterDate" placeholder="最終更新日フィルター" class="form-control">
                <input type="text" id="deviceGroupFilterNotes" placeholder="備考フィルター" class="form-control">
                <button class="btn btn-primary" onclick="filterTableByText('deviceGroupTable')">適用</button>
            </div>
            <ul class="nav nav-tabs filter-tabs" id="deviceGroupTabs">
                <li class="nav-item">
                    <a class="nav-link active" data-toggle="tab" href="#deviceGroupAll" onclick="filterTable('deviceGroupTable', '')">全て</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" data-toggle="tab" href="#deviceGroupEnabled" onclick="filterTable('deviceGroupTable', '有効')">有効</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" data-toggle="tab" href="#deviceGroupDisabled" onclick="filterTable('deviceGroupTable', '無効')">無効</a>
                </li>
            </ul>
            <div class="table-wrapper">
                <div class="table-count">件数: <span id="deviceGroupCount"></span></div>
                <table class="table table-bordered mt-3" id="deviceGroupTable">
                    <thead>
                        <tr>
                            <th class="sticky"><input type="checkbox" class="form-check-input"></th>
                            <th class="sticky">No</th>
                            <th class="sticky">有効無効</th>
                            <th>グループ名</th>
                            <th>登録デバイス数</th>
                            <th>最終更新日</th>
                            <th>備考</th>
                            <th>編集</th>
                            <th>削除</th>
                        </tr>
                    </thead>
                    <tbody>
                        <!-- ダミーデータ -->
                        <tr>
                            <td><input type="checkbox" class="form-check-input"></td>
                            <td>1</td>
                            <td>有効</td>
                            <td>Group A</td>
                            <td>10</td>
                            <td>2024/06/19</td>
                            <td></td>
                            <td><button class="btn btn-primary">編集</button></td>
                            <td><button class="btn btn-danger" onclick="deleteRow(this)">削除</button></td>
                        </tr>
                        <tr>
                            <td><input type="checkbox" class="form-check-input"></td>
                            <td>2</td>
                            <td>無効</td>
                            <td>Group B</td>
                            <td>5</td>
                            <td>2024/06/18</td>
                            <td></td>
                            <td><button class="btn btn-primary">編集</button></td>
                            <td><button class="btn btn-danger" onclick="deleteRow(this)">削除</button></td>
                        </tr>
                        <!-- ダミーデータここまで -->
                    </tbody>
                </table>
            </div>
            <nav>
                <ul class="pagination justify-content-center" id="deviceGroupPagination"></ul>
            </nav>
        </div>
        <div class="main-content" id="task-management">
            <h1>タスク管理</h1>
            <div class="mb-3 mt-3">
                <button class="btn btn-success" onclick="addRow('taskTable')">新規登録</button>
                <button class="btn btn-info" onclick="downloadCSV('taskTable')">CSVダウンロード</button>
            </div>
            <div class="filter-section">
                <input type="text" id="taskFilterNo" placeholder="Noフィルター" class="form-control">
                <input type="text" id="taskFilterStatus" placeholder="有効無効フィルター" class="form-control">
                <input type="text" id="taskFilterName" placeholder="タスク名フィルター" class="form-control">
                <input type="text" id="taskFilterDate" placeholder="指定日時フィルター" class="form-control">
                <input type="text" id="taskFilterRepeat" placeholder="繰返条件フィルター" class="form-control">
                <input type="text" id="taskFilterTime" placeholder="時間フィルター" class="form-control">
                <input type="text" id="taskFilterFile" placeholder="ファイル名フィルター" class="form-control">
                <input type="text" id="taskFilterSource" placeholder="コピー元フィルター" class="form-control">
                <input type="text" id="taskFilterDestination" placeholder="コピー先フィルター" class="form-control">
                <input type="text" id="taskFilterTags" placeholder="タグフィルター" class="form-control">
                <input type="text" id="taskFilterUpdateDate" placeholder="最終更新日フィルター" class="form-control">
                <input type="text" id="taskFilterNotes" placeholder="備考フィルター" class="form-control">
                <button class="btn btn-primary" onclick="filterTableByText('taskTable')">適用</button>
            </div>
            <ul class="nav nav-tabs filter-tabs" id="taskTabs">
                <li class="nav-item">
                    <a class="nav-link active" data-toggle="tab" href="#taskAll" onclick="filterTable('taskTable', '')">全て</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" data-toggle="tab" href="#taskEnabled" onclick="filterTable('taskTable', '有効')">有効</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" data-toggle="tab" href="#taskDisabled" onclick="filterTable('taskTable', '無効')">無効</a>
                </li>
            </ul>
            <div class="table-wrapper">
                <div class="table-count">件数: <span id="taskCount"></span></div>
                <table class="table table-bordered mt-3" id="taskTable">
                    <thead>
                        <tr>
                            <th class="sticky"><input type="checkbox" class="form-check-input"></th>
                            <th class="sticky">No</th>
                            <th class="sticky">有効無効</th>
                            <th>タスク名</th>
                            <th>指定日時</th>
                            <th>繰返条件</th>
                            <th>時間</th>
                            <th>ファイル名</th>
                            <th>コピー元ファイルパス</th>
                            <th>サーバーファイル指定</th>
                            <th>コピー先ファイルパス</th>
                            <th>コピー後の動作</th>
                            <th>タグ</th>
                            <th>最終更新日</th>
                            <th>備考</th>
                            <th>編集</th>
                            <th>削除</th>
                        </tr>
                    </thead>
                    <tbody>
                        <!-- ダミーデータ -->
                        <tr>
                            <td><input type="checkbox" class="form-check-input"></td>
                            <td>1</td>
                            <td>有効</td>
                            <td>Task A</td>
                            <td contenteditable="true">2024-06-19</td>
                            <td contenteditable="true">毎日</td>
                            <td contenteditable="true">14:00</td>
                            <td>fileA.txt</td>
                            <td contenteditable="true">C:\source\fileA.txt</td>
                            <td><button class="btn btn-sm btn-secondary" onclick="showServerFileDialog(this)">サーバーファイル指定</button></td>
                            <td contenteditable="true">C:\destination\fileA.txt</td>
                            <td>
                                <select class="form-control">
                                    <option>何もしない</option>
                                    <option>コピーしたファイルを実行</option>
                                </select>
                            </td>
                            <td>
                                <select multiple class="form-control">
                                    <option>Tag A</option>
                                    <option>Tag B</option>
                                </select>
                            </td>
                            <td>2024/06/19</td>
                            <td contenteditable="true"></td>
                            <td><button class="btn btn-primary">編集</button></td>
                            <td><button class="btn btn-danger" onclick="deleteRow(this)">削除</button></td>
                        </tr>
                        <tr>
                            <td><input type="checkbox" class="form-check-input"></td>
                            <td>2</td>
                            <td>無効</td>
                            <td>Task B</td>
                            <td contenteditable="true">2024-06-18</td>
                            <td contenteditable="true">毎週</td>
                            <td contenteditable="true">10:00</td>
                            <td>fileB.txt</td>
                            <td contenteditable="true">C:\source\fileB.txt</td>
                            <td><button class="btn btn-sm btn-secondary" onclick="showServerFileDialog(this)">サーバーファイル指定</button></td>
                            <td contenteditable="true">C:\destination\fileB.txt</td>
                            <td>
                                <select class="form-control">
                                    <option>何もしない</option>
                                    <option>コピーしたファイルを実行</option>
                                </select>
                            </td>
                            <td>
                                <select multiple class="form-control">
                                    <option>Tag A</option>
                                    <option>Tag B</option>
                                </select>
                            </td>
                            <td>2024/06/18</td>
                            <td contenteditable="true"></td>
                            <td><button class="btn btn-primary">編集</button></td>
                            <td><button class="btn btn-danger" onclick="deleteRow(this)">削除</button></td>
                        </tr>
                        <!-- ダミーデータここまで -->
                    </tbody>
                </table>
            </div>
            <nav>
                <ul class="pagination justify-content-center" id="taskPagination"></ul>
            </nav>
        </div>
        <div class="main-content" id="task-group-management">
            <h1>タスクグループ管理</h1>
            <div class="mb-3 mt-3">
                <button class="btn btn-success" onclick="addRow('taskGroupTable')">新規登録</button>
                <button class="btn btn-info" onclick="downloadCSV('taskGroupTable')">CSVダウンロード</button>
            </div>
            <div class="filter-section">
                <input type="text" id="taskGroupFilterNo" placeholder="Noフィルター" class="form-control">
                <input type="text" id="taskGroupFilterStatus" placeholder="有効無効フィルター" class="form-control">
                <input type="text" id="taskGroupFilterName" placeholder="グループ名フィルター" class="form-control">
                <input type="text" id="taskGroupFilterCount" placeholder="登録タスク数フィルター" class="form-control">
                <input type="text" id="taskGroupFilterDate" placeholder="最終更新日フィルター" class="form-control">
                <input type="text" id="taskGroupFilterNotes" placeholder="備考フィルター" class="form-control">
                <button class="btn btn-primary" onclick="filterTableByText('taskGroupTable')">適用</button>
            </div>
            <ul class="nav nav-tabs filter-tabs" id="taskGroupTabs">
                <li class="nav-item">
                    <a class="nav-link active" data-toggle="tab" href="#taskGroupAll" onclick="filterTable('taskGroupTable', '')">全て</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" data-toggle="tab" href="#taskGroupEnabled" onclick="filterTable('taskGroupTable', '有効')">有効</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" data-toggle="tab" href="#taskGroupDisabled" onclick="filterTable('taskGroupTable', '無効')">無効</a>
                </li>
            </ul>
            <div class="table-wrapper">
                <div class="table-count">件数: <span id="taskGroupCount"></span></div>
                <table class="table table-bordered mt-3" id="taskGroupTable">
                    <thead>
                        <tr>
                            <th class="sticky"><input type="checkbox" class="form-check-input"></th>
                            <th class="sticky">No</th>
                            <th class="sticky">有効無効</th>
                            <th>グループ名</th>
                            <th>登録タスク数</th>
                            <th>最終更新日</th>
                            <th>備考</th>
                            <th>編集</th>
                            <th>削除</th>
                        </tr>
                    </thead>
                    <tbody>
                        <!-- ダミーデータ -->
                        <tr>
                            <td><input type="checkbox" class="form-check-input"></td>
                            <td>1</td>
                            <td>有効</td>
                            <td>Task Group A</td>
                            <td>10</td>
                            <td>2024/06/19</td>
                            <td></td>
                            <td><button class="btn btn-primary">編集</button></td>
                            <td><button class="btn btn-danger" onclick="deleteRow(this)">削除</button></td>
                        </tr>
                        <tr>
                            <td><input type="checkbox" class="form-check-input"></td>
                            <td>2</td>
                            <td>無効</td>
                            <td>Task Group B</td>
                            <td>5</td>
                            <td>2024/06/18</td>
                            <td></td>
                            <td><button class="btn btn-primary">編集</button></td>
                            <td><button class="btn btn-danger" onclick="deleteRow(this)">削除</button></td>
                        </tr>
                        <!-- ダミーデータここまで -->
                    </tbody>
                </table>
            </div>
            <nav>
                <ul class="pagination justify-content-center" id="taskGroupPagination"></ul>
            </nav>
        </div>
        <div class="main-content" id="tag-device-management">
            <h1>タグでデバイス管理</h1>
            <div class="mb-3 mt-3">
                <button class="btn btn-success" onclick="addRow('tagDeviceTable')">新規登録</button>
                <button class="btn btn-info" onclick="downloadCSV('tagDeviceTable')">CSVダウンロード</button>
            </div>
            <div class="filter-section">
                <input type="text" id="tagDeviceFilterNo" placeholder="Noフィルター" class="form-control">
                <input type="text" id="tagDeviceFilterStatus" placeholder="有効無効フィルター" class="form-control">
                <input type="text" id="tagDeviceFilterName" placeholder="タグ名フィルター" class="form-control">
                <input type="text" id="tagDeviceFilterCount" placeholder="登録デバイス数フィルター" class="form-control">
                <input type="text" id="tagDeviceFilterDate" placeholder="最終更新日フィルター" class="form-control">
                <input type="text" id="tagDeviceFilterNotes" placeholder="備考フィルター" class="form-control">
                <button class="btn btn-primary" onclick="filterTableByText('tagDeviceTable')">適用</button>
            </div>
            <div class="table-wrapper">
                <div class="table-count">件数: <span id="tagDeviceCount"></span></div>
                <table class="table table-bordered mt-3" id="tagDeviceTable">
                    <thead>
                        <tr>
                            <th class="sticky"><input type="checkbox" class="form-check-input"></th>
                            <th class="sticky">No</th>
                            <th class="sticky">有効無効</th>
                            <th>タグ名</th>
                            <th>登録デバイス数</th>
                            <th>最終更新日</th>
                            <th>備考</th>
                            <th>編集</th>
                            <th>削除</th>
                        </tr>
                    </thead>
                    <tbody>
                        <!-- ダミーデータ -->
                        <tr>
                            <td><input type="checkbox" class="form-check-input"></td>
                            <td>1</td>
                            <td>有効</td>
                            <td>Tag A</td>
                            <td>10</td>
                            <td>2024/06/19</td>
                            <td></td>
                            <td><button class="btn btn-primary">編集</button></td>
                            <td><button class="btn btn-danger" onclick="deleteRow(this)">削除</button></td>
                        </tr>
                        <tr>
                            <td><input type="checkbox" class="form-check-input"></td>
                            <td>2</td>
                            <td>無効</td>
                            <td>Tag B</td>
                            <td>5</td>
                            <td>2024/06/18</td>
                            <td></td>
                            <td><button class="btn btn-primary">編集</button></td>
                            <td><button class="btn btn-danger" onclick="deleteRow(this)">削除</button></td>
                        </tr>
                        <!-- ダミーデータここまで -->
                    </tbody>
                </table>
            </div>
            <nav>
                <ul class="pagination justify-content-center" id="tagDevicePagination"></ul>
            </nav>
        </div>
        <div class="main-content" id="tag-task-management">
            <h1>タグでタスク管理</h1>
            <div class="mb-3 mt-3">
                <button class="btn btn-success" onclick="addRow('tagTaskTable')">新規登録</button>
                <button class="btn btn-info" onclick="downloadCSV('tagTaskTable')">CSVダウンロード</button>
            </div>
            <div class="filter-section">
                <input type="text" id="tagTaskFilterNo" placeholder="Noフィルター" class="form-control">
                <input type="text" id="tagTaskFilterStatus" placeholder="有効無効フィルター" class="form-control">
                <input type="text" id="tagTaskFilterName" placeholder="タグ名フィルター" class="form-control">
                <input type="text" id="tagTaskFilterCount" placeholder="登録タスク数フィルター" class="form-control">
                <input type="text" id="tagTaskFilterDate" placeholder="最終更新日フィルター" class="form-control">
                <input type="text" id="tagTaskFilterNotes" placeholder="備考フィルター" class="form-control">
                <button class="btn btn-primary" onclick="filterTableByText('tagTaskTable')">適用</button>
            </div>
            <div class="table-wrapper">
                <div class="table-count">件数: <span id="tagTaskCount"></span></div>
                <table class="table table-bordered mt-3" id="tagTaskTable">
                    <thead>
                        <tr>
                            <th class="sticky"><input type="checkbox" class="form-check-input"></th>
                            <th class="sticky">No</th>
                            <th class="sticky">有効無効</th>
                            <th>タグ名</th>
                            <th>登録タスク数</th>
                            <th>最終更新日</th>
                            <th>備考</th>
                            <th>編集</th>
                            <th>削除</th>
                        </tr>
                    </thead>
                    <tbody>
                        <!-- ダミーデータ -->
                        <tr>
                            <td><input type="checkbox" class="form-check-input"></td>
                            <td>1</td>
                            <td>有効</td>
                            <td>Tag A</td>
                            <td>10</td>
                            <td>2024/06/19</td>
                            <td></td>
                            <td><button class="btn btn-primary">編集</button></td>
                            <td><button class="btn btn-danger" onclick="deleteRow(this)">削除</button></td>
                        </tr>
                        <tr>
                            <td><input type="checkbox" class="form-check-input"></td>
                            <td>2</td>
                            <td>無効</td>
                            <td>Tag B</td>
                            <td>5</td>
                            <td>2024/06/18</td>
                            <td></td>
                            <td><button class="btn btn-primary">編集</button></td>
                            <td><button class="btn btn-danger" onclick="deleteRow(this)">削除</button></td>
                        </tr>
                        <!-- ダミーデータここまで -->
                    </tbody>
                </table>
            </div>
            <nav>
                <ul class="pagination justify-content-center" id="tagTaskPagination"></ul>
            </nav>
        </div>
        <div class="main-content" id="tag-management">
            <h1>タグ管理</h1>
            <div class="mb-3 mt-3">
                <button class="btn btn-success" onclick="addRow('tagTable')">新規登録</button>
                <button class="btn btn-info" onclick="downloadCSV('tagTable')">CSVダウンロード</button>
            </div>
            <div class="filter-section">
                <input type="text" id="tagFilterNo" placeholder="Noフィルター" class="form-control">
                <input type="text" id="tagFilterName" placeholder="タグ名フィルター" class="form-control">
                <input type="text" id="tagFilterTags" placeholder="付与タグフィルター" class="form-control">
                <input type="text" id="tagFilterNotes" placeholder="備考フィルター" class="form-control">
                <input type="text" id="tagFilterDate" placeholder="更新日フィルター" class="form-control">
                <button class="btn btn-primary" onclick="filterTableByText('tagTable')">適用</button>
            </div>
            <div class="table-wrapper">
                <div class="table-count">件数: <span id="tagCount"></span></div>
                <table class="table table-bordered mt-3" id="tagTable">
                    <thead>
                        <tr>
                            <th class="sticky"><input type="checkbox" class="form-check-input"></th>
                            <th class="sticky">No</th>
                            <th class="sticky">タグ名</th>
                            <th>付与タグ</th>
                            <th>備考</th>
                            <th>更新日</th>
                            <th>編集</th>
                            <th>削除</th>
                        </tr>
                    </thead>
                    <tbody>
                        <!-- ダミーデータ -->
                        <tr>
                            <td><input type="checkbox" class="form-check-input"></td>
                            <td>1</td>
                            <td>Tag A</td>
                            <td>
                                <select multiple class="form-control">
                                    <option>Tag B</option>
                                    <option>Tag C</option>
                                </select>
                            </td>
                            <td></td>
                            <td>2024/06/19</td>
                            <td><button class="btn btn-primary">編集</button></td>
                            <td><button class="btn btn-danger" onclick="deleteRow(this)">削除</button></td>
                        </tr>
                        <tr>
                            <td><input type="checkbox" class="form-check-input"></td>
                            <td>2</td>
                            <td>Tag B</td>
                            <td>
                                <select multiple class="form-control">
                                    <option>Tag A</option>
                                    <option>Tag C</option>
                                </select>
                            </td>
                            <td></td>
                            <td>2024/06/18</td>
                            <td><button class="btn btn-primary">編集</button></td>
                            <td><button class="btn btn-danger" onclick="deleteRow(this)">削除</button></td>
                        </tr>
                        <!-- ダミーデータここまで -->
                    </tbody>
                </table>
            </div>
            <nav>
                <ul class="pagination justify-content-center" id="tagPagination"></ul>
            </nav>
        </div>
        <div class="main-content" id="user-management">
            <h1>ユーザー管理</h1>
            <div class="mb-3 mt-3">
                <button class="btn btn-success" onclick="addRow('userTable')">新規登録</button>
                <button class="btn btn-info" onclick="downloadCSV('userTable')">CSVダウンロード</button>
            </div>
            <div class="filter-section">
                <input type="text" id="userFilterNo" placeholder="Noフィルター" class="form-control">
                <input type="text" id="userFilterStatus" placeholder="有効無効フィルター" class="form-control">
                <input type="text" id="userFilterId" placeholder="IDフィルター" class="form-control">
                <input type="text" id="userFilterRole" placeholder="役割フィルター" class="form-control">
                <input type="text" id="userFilterName" placeholder="ユーザー名フィルター" class="form-control">
                <input type="text" id="userFilterPassword" placeholder="パスワードフィルター" class="form-control">
                <input type="text" id="userFilterOrg" placeholder="組織フィルター" class="form-control">
                <input type="text" id="userFilterLastAccess" placeholder="最終アクセスフィルター" class="form-control">
                <input type="text" id="userFilterNotes" placeholder="備考フィルター" class="form-control">
                <button class="btn btn-primary" onclick="filterTableByText('userTable')">適用</button>
            </div>
            <ul class="nav nav-tabs filter-tabs" id="userTabs">
                <li class="nav-item">
                    <a class="nav-link active" data-toggle="tab" href="#userAll" onclick="filterTable('userTable', '')">全て</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" data-toggle="tab" href="#userEnabled" onclick="filterTable('userTable', '有効')">有効</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" data-toggle="tab" href="#userDisabled" onclick="filterTable('userTable', '無効')">無効</a>
                </li>
            </ul>
            <div class="table-wrapper">
                <div class="table-count">件数: <span id="userCount"></span></div>
                <table class="table table-bordered mt-3" id="userTable">
                    <thead>
                        <tr>
                            <th class="sticky"><input type="checkbox" class="form-check-input"></th>
                            <th class="sticky">No</th>
                            <th class="sticky">管理の有効無効</th>
                            <th>ID</th>
                            <th>役割</th>
                            <th>ユーザー名</th>
                            <th>パスワード</th>
                            <th>組織</th>
                            <th>最終アクセス</th>
                            <th>備考</th>
                            <th>編集</th>
                            <th>削除</th>
                        </tr>
                    </thead>
                    <tbody>
                        <!-- ダミーデータ -->
                        <tr>
                            <td><input type="checkbox" class="form-check-input"></td>
                            <td>1</td>
                            <td>有効</td>
                            <td>001</td>
                            <td>管理者</td>
                            <td>User A</td>
                            <td>password</td>
                            <td>Organization 1</td>
                            <td>2024/06/19 10:00</td>
                            <td contenteditable="true"></td>
                            <td><button class="btn btn-primary">編集</button></td>
                            <td><button class="btn btn-danger" onclick="deleteRow(this)">削除</button></td>
                        </tr>
                        <tr>
                            <td><input type="checkbox" class="form-check-input"></td>
                            <td>2</td>
                            <td>無効</td>
                            <td>002</td>
                            <td>ユーザー</td>
                            <td>User B</td>
                            <td>password</td>
                            <td>Organization 2</td>
                            <td>2024/06/18 14:30</td>
                            <td contenteditable="true"></td>
                            <td><button class="btn btn-primary">編集</button></td>
                            <td><button class="btn btn-danger" onclick="deleteRow(this)">削除</button></td>
                        </tr>
                        <!-- ダミーデータここまで -->
                    </tbody>
                </table>
            </div>
            <nav>
                <ul class="pagination justify-content-center" id="userPagination"></ul>
            </nav>
        </div>
    </div>

    <div class="modal fade" id="serverFileDialog" tabindex="-1" role="dialog" aria-labelledby="serverFileDialogTitle" aria-hidden="true">
        <div class="modal-dialog" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="serverFileDialogTitle">サーバーファイル指定</h5>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body">
                    <div class="mb-3">
                        <input type="file" class="form-control-file" id="uploadFile">
                        <button class="btn btn-secondary mt-2" onclick="uploadFile()">アップロード</button>
                    </div>
                    <div class="mt-3">
                        <label for="uploadedFiles">アップロード済みファイル</label>
                        <select class="form-control" id="uploadedFiles">
                            <!-- ダミーファイルデータ -->
                            <option value="C:\server\file1.txt">file1.txt</option>
                            <option value="C:\server\file2.txt">file2.txt</option>
                            <option value="C:\server\file3.txt">file3.txt</option>
                        </select>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-primary" onclick="applyServerFilePath()">適用</button>
                    <button type="button" class="btn btn-secondary" data-dismiss="modal">閉じる</button>
                </div>
            </div>
        </div>
    </div>

    <script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.5.2/dist/umd/popper.min.js"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.29.1/moment.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/fullcalendar/3.10.2/fullcalendar.min.js"></script>
    <script>
        let currentServerFileInput;
        let taskEvents = [
            {
                title: 'Task A',
                start: '2024-06-19',
                group: 'Task Group A'
            },
            {
                title: 'Task B',
                start: '2024-06-18',
                group: 'Task Group B'
            },
            {
                title: 'Task C',
                start: '2024-06-20',
                group: 'Task Group A'
            },
            {
                title: 'Task D',
                start: '2024-06-21',
                group: 'Task Group B'
            }
        ];

        function showPage(event, pageId) {
            var pages = document.querySelectorAll('.main-content');
            pages.forEach(function(page) {
                page.classList.remove('active');
            });
            document.getElementById(pageId).classList.add('active');
            
            var navItems = document.querySelectorAll('.sidebar ul li');
            navItems.forEach(function(navItem) {
                navItem.classList.remove('active');
            });
            if(event && event.target) {
                event.target.classList.add('active');
            }
        }

        function filterTable(tableId, filter) {
            var table = document.getElementById(tableId);
            var rows = table.getElementsByTagName('tr');
            for (var i = 1; i < rows.length; i++) {
                var cells = rows[i].getElementsByTagName('td');
                var status = cells[2].textContent || cells[2].innerText;
                if (filter === '' || status === filter) {
                    rows[i].style.display = '';
                } else {
                    rows[i].style.display = 'none';
                }
            }
            updateCount(tableId);
        }

        function filterTableByText(tableId) {
            var filters = [];
            var table = document.getElementById(tableId);
            var rows = table.getElementsByTagName('tr');

            if (tableId === 'deviceTable') {
                filters = [
                    document.getElementById('deviceFilterNo').value.toLowerCase(),
                    document.getElementById('deviceFilterStatus').value.toLowerCase(),
                    document.getElementById('deviceFilterName').value.to.lowerCase(),
                    document.getElementById('deviceFilterHwid').value.to.lowerCase(),
                    document.getElementById('deviceFilterUser').value.to.lowerCase(),
                    document.getElementById('deviceFilterPassword').value.to.lowerCase(),
                    document.getElementById('deviceFilterGroup').value.to.lowerCase(),
                    document.getElementById('deviceFilterIp').value.to.lowerCase(),
                    document.getElementById('deviceFilterLastAccess').value.to.lowerCase(),
                    document.getElementById('deviceFilterTags').value.to.lowerCase(),
                    document.getElementById('deviceFilterNotes').value.to.lowerCase()
                ];
            } else if (tableId === 'deviceGroupTable') {
                filters = [
                    document.getElementById('deviceGroupFilterNo').value.to.lowerCase(),
                    document.getElementById('deviceGroupFilterStatus').value.to.lowerCase(),
                    document.getElementById('deviceGroupFilterName').value.to.lowerCase(),
                    document.getElementById('deviceGroupFilterCount').value.to.lowerCase(),
                    document.getElementById('deviceGroupFilterDate').value.to.lowerCase(),
                    document.getElementById('deviceGroupFilterNotes').value.to.lowerCase()
                ];
            } else if (tableId === 'taskTable') {
                filters = [
                    document.getElementById('taskFilterNo').value.to.lowerCase(),
                    document.getElementById('taskFilterStatus').value.to.lowerCase(),
                    document.getElementById('taskFilterName').value.to.lowerCase(),
                    document.getElementById('taskFilterDate').value.to.lowerCase(),
                    document.getElementById('taskFilterRepeat').value.to.lowerCase(),
                    document.getElementById('taskFilterTime').value.to.lowerCase(),
                    document.getElementById('taskFilterFile').value.to.lowerCase(),
                    document.getElementById('taskFilterSource').value.to.lowerCase(),
                    document.getElementById('taskFilterDestination').value.to.lowerCase(),
                    document.getElementById('taskFilterTags').value.to.lowerCase(),
                    document.getElementById('taskFilterUpdateDate').value.to.lowerCase(),
                    document.getElementById('taskFilterNotes').value.to.lowerCase()
                ];
            } else if (tableId === 'taskGroupTable') {
                filters = [
                    document.getElementById('taskGroupFilterNo').value.to.lowerCase(),
                    document.getElementById('taskGroupFilterStatus').value.to.lowerCase(),
                    document.getElementById('taskGroupFilterName').value.to.lowerCase(),
                    document.getElementById('taskGroupFilterCount').value.to.lowerCase(),
                    document.getElementById('taskGroupFilterDate').value.to.lowerCase(),
                    document.getElementById('taskGroupFilterNotes').value.to.lowerCase()
                ];
            } else if (tableId === 'userTable') {
                filters = [
                    document.getElementById('userFilterNo').value.to.lowerCase(),
                    document.getElementById('userFilterStatus').value.to.lowerCase(),
                    document.getElementById('userFilterId').value.to.lowerCase(),
                    document.getElementById('userFilterRole').value.to.lowerCase(),
                    document.getElementById('userFilterName').value.to.lowerCase(),
                    document.getElementById('userFilterPassword').value.to.lowerCase(),
                    document.getElementById('userFilterOrg').value.to.lowerCase(),
                    document.getElementById('userFilterLastAccess').value.to.lowerCase(),
                    document.getElementById('userFilterNotes').value.to.lowerCase()
                ];
            } else if (tableId === 'logTable') {
                filters = [
                    document.getElementById('logFilterDevice').value.to.lowerCase(),
                    document.getElementById('logFilterGroup').value.to.lowerCase(),
                    document.getElementById('logFilterTask').value.to.lowerCase(),
                    document.getElementById('logFilterTaskGroup').value.to.lowerCase(),
                    document.getElementById('logFilterStatus').value.to.lowerCase(),
                    document.getElementById('logFilterLastUpdate').value.to.lowerCase(),
                    document.getElementById('logFilterNotes').value.to.lowerCase()
                ];
            } else if (tableId === 'tagTable') {
                filters = [
                    document.getElementById('tagFilterNo').value.to.lowerCase(),
                    document.getElementById('tagFilterName').value.to.lowerCase(),
                    document.getElementById('tagFilterTags').value.to.lowerCase(),
                    document.getElementById('tagFilterNotes').value.to.lowerCase(),
                    document.getElementById('tagFilterDate').value.to.lowerCase()
                ];
            } else if (tableId === 'tagDeviceTable') {
                filters = [
                    document.getElementById('tagDeviceFilterNo').value.to.lowerCase(),
                    document.getElementById('tagDeviceFilterStatus').value.to.lowerCase(),
                    document.getElementById('tagDeviceFilterName').value.to.lowerCase(),
                    document.getElementById('tagDeviceFilterCount').value.to.lowerCase(),
                    document.getElementById('tagDeviceFilterDate').value.to.lowerCase(),
                    document.getElementById('tagDeviceFilterNotes').value.to.lowerCase()
                ];
            } else if (tableId === 'tagTaskTable') {
                filters = [
                    document.getElementById('tagTaskFilterNo').value.to.lowerCase(),
                    document.getElementById('tagTaskFilterStatus').value.to.lowerCase(),
                    document.getElementById('tagTaskFilterName').value.to.lowerCase(),
                    document.getElementById('tagTaskFilterCount').value.to.lowerCase(),
                    document.getElementById('tagTaskFilterDate').value.to.lowerCase(),
                    document.getElementById('tagTaskFilterNotes').value.to.lowerCase()
                ];
            }

            for (var i = 1; i < rows.length; i++) {
                var cells = rows[i].getElementsByTagName('td');
                var showRow = true;
                for (var j = 0; j < filters.length; j++) {
                    var cellContent = cells[j].textContent || cells[j].innerText;
                    if (cellContent.toLowerCase().indexOf(filters[j]) === -1) {
                        showRow = false;
                        break;
                    }
                }
                rows[i].style.display = showRow ? '' : 'none';
            }
            updateCount(tableId);
        }

        function updateCount(tableId) {
            var table = document.getElementById(tableId);
            var rows = table.getElementsByTagName('tr');
            var count = 0;
            for (var i = 1; i < rows.length; i++) {
                if (rows[i].style.display !== 'none') {
                    count++;
                }
            }
            document.getElementById(tableId + 'Count').textContent = count;
        }

        function addRow(tableId) {
            var table = document.getElementById(tableId).getElementsByTagName('tbody')[0];
            var newRow = table.insertRow();
            var cellCount = table.rows[0].cells.length;

            for (var i = 0; i < cellCount; i++) {
                var newCell = newRow.insertCell(i);
                if (i === cellCount - 3) {
                    newCell.innerHTML = '<button class="btn btn-primary">編集</button>';
                } else if (i === cellCount - 2) {
                    newCell.innerHTML = '<button class="btn btn-danger" onclick="deleteRow(this)">削除</button>';
                } else {
                    newCell.contentEditable = true;
                }
            }
        }

        function deleteRow(button) {
            var row = button.parentNode.parentNode;
            row.parentNode.removeChild(row);
        }

        function downloadCSV(tableId) {
            var table = document.getElementById(tableId);
            var rows = table.getElementsByTagName('tr');
            var csv = [];
            for (var i = 0; i < rows.length; i++) {
                var cells = rows[i].getElementsByTagName('th');
                if (cells.length === 0) {
                    cells = rows[i].getElementsByTagName('td');
                }
                var row = [];
                for (var j = 0; j < cells.length; j++) {
                    row.push(cells[j].innerText);
                }
                csv.push(row.join(','));
            }
            var csvFile = new Blob([csv.join('\n')], {type: 'text/csv'});
            var downloadLink = document.createElement('a');
            downloadLink.download = tableId + '.csv';
            downloadLink.href = window.URL.createObjectURL(csvFile);
            downloadLink.style.display = 'none';
            document.body.appendChild(downloadLink);
            downloadLink.click();
            document.body.removeChild(downloadLink);
        }

        function changeView(view) {
            $('#calendar').fullCalendar('changeView', view);
        }

        function filterCalendar() {
            var filter = document.getElementById('taskGroupFilterCalendar').value;
            $('#calendar').fullCalendar('removeEvents');
            $('#calendar').fullCalendar('addEventSource', function(start, end, timezone, callback) {
                var filteredEvents = taskEvents.filter(function(event) {
                    return filter === '' || event.group === filter;
                });
                callback(filteredEvents);
            });
        }

        function uploadFile() {
            var input = document.getElementById('uploadFile');
            var file = input.files[0];
            if (file) {
                var reader = new FileReader();
                reader.onload = function(e) {
                    // ファイルの読み込み処理をここに追加
                    console.log('ファイルが読み込まれました: ' + file.name);
                };
                reader.readAsDataURL(file);
            }
        }

        function showServerFileDialog(button) {
            currentServerFileInput = button;
            $('#serverFileDialog').modal('show');
        }

        function applyServerFilePath() {
            if (currentServerFileInput) {
                var select = document.getElementById('uploadedFiles');
                var selectedFile = select.options[select.selectedIndex].value;
                currentServerFileInput.textContent = selectedFile;
                $('#serverFileDialog').modal('hide');
            }
        }

        $(document).ready(function() {
            $('#calendar').fullCalendar({
                header: {
                    left: 'prev,next today',
                    center: 'title',
                    right: 'month,agendaWeek,agendaDay'
                },
                defaultView: 'month',
                editable: true,
                events: taskEvents
            });
        });
    </script>
</body>
</html>
