<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>多項式回帰分析</title>
    <link href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" rel="stylesheet">
</head>
<body>
    <div class="container mt-5">
        <h1 class="text-center mb-4">多項式回帰分析</h1>
        
        <!-- 読み込みエリア -->
        <div id="dropArea" class="border border-primary rounded p-5 text-center">
            <p>ここにCSVファイルをドラッグ＆ドロップするか、クリックしてファイルを選択してください。</p>
            <input type="file" id="csvFileInput" class="form-control-file" accept=".csv" onchange="loadFile(event)" style="display: none;">
        </div>
        
        <!-- エンコード選択エリア -->
        <div class="form-group mt-3">
            <label for="encodingSelect">エンコードを選択:</label>
            <select id="encodingSelect" class="form-control">
                <option value="UTF-8" selected>UTF-8</option>
                <option value="Shift_JIS">Shift JIS</option>
            </select>
        </div>
        
        <!-- フィールド選択エリア -->
        <div class="form-group mt-3">
            <label for="xFieldSelect">X軸のフィールドを選択:</label>
            <select id="xFieldSelect" class="form-control"></select>
        </div>
        <div class="form-group mt-3">
            <label for="yFieldSelect">Y軸のフィールドを選択:</label>
            <select id="yFieldSelect" class="form-control"></select>
        </div>
        <div class="form-group mt-3">
            <label for="seriesFieldSelect">データ系列にするフィールドを選択:</label>
            <select id="seriesFieldSelect" class="form-control"></select>
        </div>
        
        <!-- 多項式選択エリア -->
        <div class="form-group mt-3">
            <label for="degreeSlider">多項式の項数を選択:</label>
            <input type="range" id="degreeSlider" class="form-control-range" min="1" max="99" value="2">
            <span id="degreeValue">2</span>
        </div>
        <button id="regressionButton" class="btn btn-primary mt-3" onclick="runPolynomialRegression()">多項式回帰の実行</button>
        <canvas id="myChart" width="400" height="400" class="mt-4"></canvas>
        
        <!-- グループ化と集計エリア -->
        <div class="form-group mt-5">
            <label>グループ化するフィールドを選択:</label>
            <div id="groupFieldSelect" class="form-check"></div>
        </div>
        <div class="form-group mt-3">
            <label>集計するフィールドを選択:</label>
            <div id="aggregateFieldSelect" class="form-check"></div>
        </div>
        <button id="aggregateButton" class="btn btn-secondary mt-3" onclick="runAggregation()">グループ化と集計の実行</button>
        <div class="table-responsive mt-3">
            <table class="table table-bordered" id="aggregateTable"></table>
        </div>
        
        <!-- ページネーション -->
        <div class="d-flex justify-content-center align-items-center mt-3">
            <button class="btn btn-light" id="prevPage">＜</button>
            <input type="number" id="pageInput" class="form-control text-center mx-2" value="1" min="1" style="width: 60px;">
            <span id="totalPages"></span>
            <button class="btn btn-light" id="nextPage">＞</button>
        </div>
        
        <!-- CSVデータ表示エリア -->
        <div class="table-responsive mt-3">
            <table class="table table-bordered" id="dataTable"></table>
        </div>
        
        <!-- ページネーション -->
        <div class="d-flex justify-content-center align-items-center mt-3">
            <button class="btn btn-light" id="prevPageBottom">＜</button>
            <input type="number" id="pageInputBottom" class="form-control text-center mx-2" value="1" min="1" style="width: 60px;">
            <span id="totalPagesBottom"></span>
            <button class="btn btn-light" id="nextPageBottom">＞</button>
        </div>
    </div>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="script.js"></script>
</body>
</html>
