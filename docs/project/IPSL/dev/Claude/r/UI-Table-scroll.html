<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8" />
  <title>ページスクロールでも固定ヘッダー</title>
  <!-- Roboto & Icons -->
  <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500&display=swap" rel="stylesheet" />
  <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet" />
  <!-- React & Babel -->
  <script src="https://cdn.jsdelivr.net/npm/react@18/umd/react.production.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/react-dom@18/umd/react-dom.production.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/@babel/standalone/babel.min.js"></script>
  <!-- Emotion & MUI -->
  <script src="https://cdn.jsdelivr.net/npm/@emotion/react@11.11.3/dist/emotion-react.umd.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/@emotion/styled@11.11.0/dist/emotion-styled.umd.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/@mui/material@5.15.3/umd/material-ui.production.min.js"></script>
  <style>
    body { font-family: Roboto, sans-serif; margin: 16px; }
  </style>
</head>
<body>
  <div id="root"></div>

  <script type="text/babel">
    const { useState } = React;
    const {
      Box, Paper, Table, TableBody, TableCell,
      TableHead, TableRow, TablePagination,
      TextField, Typography, styled, useTheme
    } = MaterialUI;

    // テーブル横方向固定用スタイル
    const StickyHeaderCell = styled(TableCell)(({ theme }) => ({
      position: 'sticky',
      top: 0,
      backgroundColor: theme.palette.background.paper,
      zIndex: theme.zIndex.appBar + 1,
      whiteSpace: 'nowrap',
    }));
    const StickyFirstCellHeader = styled(TableCell)(({ theme }) => ({
      position: 'sticky',
      top: 0,
      left: 0,
      backgroundColor: theme.palette.background.paper,
      zIndex: theme.zIndex.appBar + 2,
      whiteSpace: 'nowrap',
    }));
    const StickyFirstCellBody = styled(TableCell)(({ theme }) => ({
      position: 'sticky',
      left: 0,
      backgroundColor: theme.palette.background.paper,
      zIndex: theme.zIndex.appBar,
      whiteSpace: 'nowrap',
    }));

    function FixedHeaderTable() {
      const theme = useTheme();
      const headers = ['列1','列2','列3','列4','列5','列6','列7'];
      const allRows = Array.from({ length: 100 }, (_, i) =>
        headers.map(h => `データ${i + 1}-${h}`)
      );

      const [filterText, setFilterText] = useState('');
      const [page, setPage] = useState(0);
      const [rowsPerPage, setRowsPerPage] = useState(10);

      const filtered = allRows.filter(row =>
        row.some(cell => cell.includes(filterText))
      );

      const minWidth = headers.length * 120;

      return (
        <Box>
          <Typography variant="h5" gutterBottom>データ一覧</Typography>
          <Box mb={2}>
            <TextField
              label="検索"
              variant="outlined"
              size="small"
              value={filterText}
              onChange={e => { setFilterText(e.target.value); setPage(0); }}
            />
          </Box>

          <Paper>
            {/* 横スクロールだけ許可 */}
            <div style={{ overflowX: 'auto', overflowY: 'visible' }}>
              <Table stickyHeader sx={{ minWidth }} size="small">
                <TableHead>
                  <TableRow>
                    {headers.map((h, i) =>
                      i === 0
                        ? <StickyFirstCellHeader key={i}><strong>{h}</strong></StickyFirstCellHeader>
                        : <StickyHeaderCell key={i}><strong>{h}</strong></StickyHeaderCell>
                    )}
                  </TableRow>
                </TableHead>
                <TableBody>
                  {filtered
                    .slice(page * rowsPerPage, page * rowsPerPage + rowsPerPage)
                    .map((row, ri) => (
                      <TableRow key={ri}>
                        {row.map((cell, ci) =>
                          ci === 0
                            ? <StickyFirstCellBody key={ci}>{cell}</StickyFirstCellBody>
                            : <TableCell key={ci} sx={{ whiteSpace: 'nowrap' }}>{cell}</TableCell>
                        )}
                      </TableRow>
                  ))}
                </TableBody>
              </Table>
            </div>

            <TablePagination
              component="div"
              count={filtered.length}
              page={page}
              onPageChange={(_, p) => setPage(p)}
              rowsPerPage={rowsPerPage}
              onRowsPerPageChange={e => {
                setRowsPerPage(+e.target.value);
                setPage(0);
              }}
              rowsPerPageOptions={[5, 10, 25, 50]}
            />
          </Paper>
        </Box>
      );
    }

    ReactDOM.createRoot(document.getElementById('root'))
      .render(<FixedHeaderTable />);
  </script>
</body>
</html>