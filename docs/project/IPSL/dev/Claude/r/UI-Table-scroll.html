<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Full-Width Sticky Header Table (No Box)</title>
  <!-- Roboto & Icons -->
  <link
    href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;600&display=swap"
    rel="stylesheet"
  />
  <link
    href="https://fonts.googleapis.com/icon?family=Material+Icons"
    rel="stylesheet"
  />
  <!-- React & Babel -->
  <script src="https://cdn.jsdelivr.net/npm/react@18/umd/react.production.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/react-dom@18/umd/react-dom.production.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/@babel/standalone/babel.min.js"></script>
  <!-- Emotion & MUI -->
  <script src="https://cdn.jsdelivr.net/npm/@emotion/react@11.11.3/dist/emotion-react.umd.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/@emotion/styled@11.11.0/dist/emotion-styled.umd.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/@mui/material@5.15.3/umd/material-ui.production.min.js"></script>
  <style>
    body {
      margin: 0;
      font-family: Roboto, sans-serif;
      background-color: #f5f5f5;
    }
    /* ヘッダー＆検索バーを中央寄せ＆幅制限 */
    .content {
      max-width: 1200px;
      margin: 0 auto;
      padding: 24px;
      box-sizing: border-box;
    }
    /* テーブル部分をフルワイド表示 */
    .table-wrapper {
      width: 100%;
      box-sizing: border-box;
    }
    /* ページネーション部分もフルワイド */
    .pagination-wrapper {
      width: 100%;
      box-sizing: border-box;
      padding: 0 24px;
      margin-top: 8px;
      display: flex;
      justify-content: flex-end;
    }
  </style>
</head>
<body>
  <div id="root"></div>

  <script type="text/babel">
    const {
      styled,
      useTheme,
      Typography,
      TextField,
      Table,
      TableHead,
      TableRow,
      TableCell,
      TableBody,
      TablePagination,
      InputAdornment,
      Chip,
      TableContainer,
      alpha
    } = MaterialUI;
    const { useState, useMemo, useCallback } = React;

    // ─── スタイリング用コンポーネント ─────────────────────────────
    // 検索バーコンテナ
    const SearchContainer = styled('div')(({ theme }) => ({
      padding: theme.spacing(3),
      backgroundColor: alpha(theme.palette.primary.main, 0.05),
      borderRadius: theme.shape.borderRadius,
      marginBottom: theme.spacing(2),
    }));

    // スティッキーセル定義
    const StickyFirstHeaderCell = styled(TableCell)(({ theme }) => ({
      position: 'sticky', top: 0, left: 0,
      backgroundColor: theme.palette.primary.main,
      color: theme.palette.primary.contrastText,
      zIndex: theme.zIndex.appBar + 2,
      whiteSpace: 'nowrap', fontWeight: 600,
      borderRight: `2px solid ${theme.palette.divider}`,
      '&::after': {
        content: '""',
        position: 'absolute',
        right: 0, top: 0, bottom: 0, width: 4,
        background: `linear-gradient(to right, ${alpha(theme.palette.common.black,0.1)}, transparent)`,
      }
    }));
    const StickyHeaderCell = styled(TableCell)(({ theme }) => ({
      position: 'sticky', top: 0,
      backgroundColor: theme.palette.primary.main,
      color: theme.palette.primary.contrastText,
      zIndex: theme.zIndex.appBar + 1,
      whiteSpace: 'nowrap', fontWeight: 600,
      borderBottom: `2px solid ${theme.palette.primary.dark}`,
    }));
    const StickyFirstBodyCell = styled(TableCell)(({ theme }) => ({
      position: 'sticky', left: 0,
      backgroundColor: alpha(theme.palette.background.paper, 0.95),
      backdropFilter: 'blur(10px)',
      zIndex: theme.zIndex.appBar,
      whiteSpace: 'nowrap', fontWeight: 500,
      borderRight: `1px solid ${theme.palette.divider}`,
      '&::after': {
        content: '""',
        position: 'absolute',
        right: 0, top: 0, bottom: 0, width: 4,
        background: `linear-gradient(to right, ${alpha(theme.palette.common.black,0.05)}, transparent)`,
      }
    }));
    const StyledTableRow = styled(TableRow)(({ theme }) => ({
      '&:nth-of-type(odd)': {
        backgroundColor: alpha(theme.palette.primary.main, 0.02),
      },
      '&:hover': {
        backgroundColor: alpha(theme.palette.primary.main, 0.08),
        cursor: 'pointer',
      },
      transition: 'background-color 0.2s ease',
    }));
    const StyledTableContainer = styled(TableContainer)(() => ({
      width: '100%',
      maxHeight: '70vh',
      overflowX: 'auto',
      overflowY: 'visible',
      boxShadow: '0px 2px 4px rgba(0,0,0,0.1)',
    }));

    // ─── ダミーデータジェネレータ ─────────────────────────────
    const generateSampleData = () => {
      const cats = ['システム','営業','管理','開発','設計'];
      const stats = ['進行中','完了','保留','計画中'];
      const prios = ['高','中','低'];
      return Array.from({ length: 150 }, (_, i) => ({
        id: i+1,
        name: `プロジェクト${String(i+1).padStart(3,'0')}`,
        category: cats[Math.floor(Math.random()*cats.length)],
        status: stats[Math.floor(Math.random()*stats.length)],
        priority: prios[Math.floor(Math.random()*prios.length)],
        startDate: new Date(2024,Math.random()*12|0,Math.random()*28+1|0)
                     .toLocaleDateString('ja-JP'),
        endDate:   new Date(2024,Math.random()*12|0,Math.random()*28+1|0)
                     .toLocaleDateString('ja-JP'),
        progress:  Math.random()*100|0 + '%',
        budget:    (Math.random()*1000|0 + 100) + '万円',
        manager:   `担当者${i+1}`,
        description: `プロジェクト${i+1}の詳細説明文です。`
      }));
    };

    // ステータスチップ
    const StatusChip = ({ status }) => {
      const color = (() => {
        switch(status) {
          case '完了':    return 'success';
          case '進行中':  return 'primary';
          case '保留':    return 'warning';
          default:        return 'default';
        }
      })();
      return <Chip label={status} color={color} size="small" variant="outlined" />;
    };

    function App() {
      const theme = useTheme();
      const [filterText, setFilterText] = useState('');
      const [page, setPage] = useState(0);
      const [rowsPerPage, setRowsPerPage] = useState(15);
      const data = useMemo(generateSampleData, []);

      const headers = [
        { key:'name',      label:'プロジェクト名', width:200 },
        { key:'category',  label:'カテゴリ',     width:120 },
        { key:'status',    label:'ステータス',   width:120 },
        { key:'priority',  label:'優先度',       width:100 },
        { key:'startDate', label:'開始日',       width:120 },
        { key:'endDate',   label:'終了日',       width:120 },
        { key:'progress',  label:'進捗',         width:100 },
        { key:'budget',    label:'予算',         width:120 },
        { key:'manager',   label:'担当者',       width:120 },
        { key:'description',label:'説明',       width:300 }
      ];

      const filtered = useMemo(() =>
        filterText
          ? data.filter(r =>
              Object.values(r).some(v =>
                v.toString().toLowerCase()
                  .includes(filterText.toLowerCase())
              )
            )
          : data
      , [data, filterText]);

      const handleFilter = useCallback(e => {
        setFilterText(e.target.value);
        setPage(0);
      }, []);
      const handlePage = useCallback((_, np) => setPage(np), []);
      const handleRowsPerPage = useCallback(e => {
        setRowsPerPage(+e.target.value);
        setPage(0);
      }, []);

      const display = useMemo(() => {
        const start = page * rowsPerPage;
        return filtered.slice(start, start + rowsPerPage);
      }, [filtered, page, rowsPerPage]);

      return (
        <>
          {/* ヘッダー＋検索バー */}
          <div className="content">
            <div style={{ marginBottom: theme.spacing(4) }}>
              <Typography variant="h4"
                sx={{ fontWeight:600, color:'primary.main' }}
              >
                プロジェクト管理システム
              </Typography>
              <Typography color="text.secondary">
                全{data.length}件のプロジェクトデータ
              </Typography>
            </div>
            <SearchContainer>
              <TextField
                fullWidth
                label="プロジェクト検索"
                variant="outlined"
                size="small"
                value={filterText}
                onChange={handleFilter}
                placeholder="プロジェクト名、カテゴリ、ステータスなどで検索..."
                InputProps={{
                  startAdornment: (
                    <InputAdornment position="start">
                      <span className="material-icons">search</span>
                    </InputAdornment>
                  )
                }}
                sx={{ '& .MuiOutlinedInput-root': { backgroundColor:'white' } }}
              />
              {filterText && (
                <div style={{ marginTop: theme.spacing(2) }}>
                  <Typography variant="body2" color="text.secondary">
                    検索結果: {filtered.length}件
                  </Typography>
                </div>
              )}
            </SearchContainer>
          </div>

          {/* テーブル本体（フルワイド） */}
          <div className="table-wrapper">
            <StyledTableContainer>
              <Table sx={{ width:'100%' }} size="small">
                <TableHead>
                  <TableRow>
                    <StickyFirstHeaderCell sx={{ width: headers[0].width }}>
                      <span className="material-icons" style={{ verticalAlign:'middle', marginRight:8 }}>
                        folder
                      </span>
                      {headers[0].label}
                    </StickyFirstHeaderCell>
                    {headers.slice(1).map(h => (
                      <StickyHeaderCell key={h.key} sx={{ width:h.width }}>
                        {h.label}
                      </StickyHeaderCell>
                    ))}
                  </TableRow>
                </TableHead>
                <TableBody>
                  {display.map(row => (
                    <StyledTableRow key={row.id}>
                      <StickyFirstBodyCell>
                        <span className="material-icons" style={{ verticalAlign:'middle', marginRight:4, color:theme.palette.primary.main }}>
                          assignment
                        </span>
                        {row.name}
                      </StickyFirstBodyCell>
                      <TableCell>
                        <Chip label={row.category} size="small" variant="outlined"/>
                      </TableCell>
                      <TableCell><StatusChip status={row.status}/></TableCell>
                      <TableCell>
                        <Chip
                          label={row.priority}
                          size="small"
                          color={
                            row.priority==='高'? 'error':
                            row.priority==='中'?'warning':'default'
                          }
                        />
                      </TableCell>
                      <TableCell>{row.startDate}</TableCell>
                      <TableCell>{row.endDate}</TableCell>
                      <TableCell>
                        <Typography variant="body2" sx={{ minWidth:40 }}>
                          {row.progress}
                        </Typography>
                      </TableCell>
                      <TableCell>{row.budget}</TableCell>
                      <TableCell>{row.manager}</TableCell>
                      <TableCell sx={{
                        maxWidth:300,
                        overflow:'hidden',
                        textOverflow:'ellipsis',
                        whiteSpace:'nowrap'
                      }}>
                        {row.description}
                      </TableCell>
                    </StyledTableRow>
                  ))}
                </TableBody>
              </Table>
            </StyledTableContainer>
          </div>

          {/* ページネーション（フルワイド） */}
          <div className="pagination-wrapper">
            <TablePagination
              component="div"
              count={filtered.length}
              page={page}
              onPageChange={handlePage}
              rowsPerPage={rowsPerPage}
              onRowsPerPageChange={handleRowsPerPage}
              rowsPerPageOptions={[10,15,25,50,100]}
              labelRowsPerPage="表示行数:"
              labelDisplayedRows={({ from, to, count }) =>
                `${from}-${to} / ${count!==-1?count:to}件`
              }
              sx={{
                borderTop:`1px solid ${theme.palette.divider}`,
                backgroundColor: alpha(theme.palette.primary.main,0.02)
              }}
            />
          </div>
        </>
      );
    }

    ReactDOM.createRoot(document.getElementById('root')).render(<App />);
  </script>
</body>
</html>