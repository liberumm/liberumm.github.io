<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8" />
  <title>è¿”ä¿¡ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆä½œæˆãƒ»ç¢ºèªã‚·ã‚¹ãƒ†ãƒ </title>
  <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700&display=swap"/>
  <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons"/>
  <script src="https://cdn.jsdelivr.net/npm/react@18.2.0/umd/react.production.min.js" crossorigin></script>
  <script src="https://cdn.jsdelivr.net/npm/react-dom@18.2.0/umd/react-dom.production.min.js" crossorigin></script>
  <script src="https://cdn.jsdelivr.net/npm/@babel/standalone@7.23.8/babel.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/@emotion/react@11.11.3/dist/emotion-react.umd.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/@emotion/styled@11.11.0/dist/emotion-styled.umd.emotion-styled.umd.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/@mui/material@5.15.3/umd/material-ui.production.min.js" crossorigin></script>

  <style>
    body { 
      margin: 0; 
      padding: 0; 
      font-family: "Roboto", sans-serif; 
      background-color: #f5f5f5;
    }
    @page {
      size: A4;
      margin: 15mm;
    }

    @media print {
       .no-print { display: none !important; }
      #preview-area { margin: 0; padding: 0; }
      body { 
        background-color: white; 
        font-size: 12pt;
        line-height: 1.4;
      }
      .print-layout {
        max-width: none !important;
        margin: 0 !important;
        padding: 20px !important;
        box-shadow: none !important;
        border: none !important;
        background: white !important;
      }
      .print-header {
        text-align: center;
        border-bottom: 2px solid #000;
        padding-bottom: 10px;
        margin-bottom: 20px;
      }
      .print-content {
        font-size: 11pt;
        line-height: 1.6;
      }
      .print-section {
        margin-bottom: 15px;
        page-break-inside: avoid;
      }
      .print-table {
        width: 100%;
        border-collapse: collapse;
        margin: 10px 0;
      }
      .print-table th,
      .print-table td {
        border: 1px solid #000;
        padding: 5px;
        font-size: 10pt;
      }
      .print-table th {
        background-color: #f0f0f0;
        font-weight: bold;
      }
    }
    .form-section {
      background: white;
      border-radius: 12px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.1);
      margin-bottom: 24px;
      overflow: hidden;
    }
    .section-header {
      background: linear-gradient(135deg, #1976d2 0%, #1565c0 100%);
      color: white;
      padding: 16px 24px;
      font-weight: 500;
    }
    .preview-card {
      background: white;
      border-radius: 12px;
      box-shadow: 0 4px 12px rgba(0,0,0,0.15);
      border: 1px solid #e0e0e0;
    }
    .info-chip {
      background: linear-gradient(135deg, #e3f2fd 0%, #bbdefb 100%);
      border-radius: 20px;
      padding: 8px 16px;
      margin: 4px;
      display: inline-block;
      font-size: 0.875rem;
      font-weight: 500;
    }
    .store-item {
      background: linear-gradient(135deg, #f3e5f5 0%, #e1bee7 100%);
      border-radius: 8px;
      padding: 12px;
      margin: 8px 0;
      border-left: 4px solid #9c27b0;
    }
    .proposal-item {
      background: linear-gradient(135deg, #fff3e0 0%, #ffcc02 100%);
      border-radius: 8px;
      padding: 8px 12px;
      margin: 4px 0;
      border-left: 4px solid #ff9800;
    }
    .floating-actions {
      position: fixed;
      bottom: 24px;
      right: 24px;
      z-index: 1000;
    }
    .action-button {
      margin-left: 12px;
      box-shadow: 0 4px 12px rgba(0,0,0,0.2);
    }
    .status-accepted {
      background: linear-gradient(135deg, #e8f5e8 0%, #c8e6c9 100%);
      border-left: 4px solid #4caf50;
    }
    .status-proposal {
      background: linear-gradient(135deg, #fff3e0 0%, #ffe0b2 100%);
      border-left: 4px solid #ff9800;
    }
    .status-declined {
      background: linear-gradient(135deg, #ffebee 0%, #ffcdd2 100%);
      border-left: 4px solid #f44336;
    }
    .applicant-view {
      background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
    }
    .admin-view {
      background: linear-gradient(135deg, #e3f2fd 0%, #bbdefb 100%);
    }
    .sticky-header {
      position: sticky;
      top: 0;
      z-index: 100;
      backdrop-filter: blur(10px);
      background-color: rgba(25, 118, 210, 0.9);
    }
    .applicant-view {
      background: linear-gradient(135deg, #2e7d32 0%, #388e3c 100%) !important;
    }
    .admin-view {
      background: linear-gradient(135deg, #1976d2 0%, #1565c0 100%) !important;
    }
  </style>
</head>
<body>
  <div id="root"></div>

<script type="text/babel">
const {
  CssBaseline, AppBar, Toolbar, Typography, Container, Button,
  FormControl, InputLabel, Select, MenuItem, Chip,
  Card, CardContent, TextField, Grid, Box, Divider, Fab,
  Table, TableHead, TableRow, TableCell, TableBody,
  IconButton, Tooltip, Paper, Stack, Alert, Switch, FormControlLabel
} = MaterialUI;

const COMMON_WORK_NOTICE = `
ã€ä»Šå¾Œã«ã¤ã„ã¦ã€‘
ä¸Šè¨˜ã®å†…å®¹ã§å—å…¥ã‚Œã®æº–å‚™ã‚’è‡´ã—ã¾ã™ã€‚ä»Šå¾Œã¯è²´æ ¡ã¨åº—èˆ—ã¨ã®ã‚„ã‚Šã¨ã‚Šã¨ãªã‚Šã¾ã™ã€‚
â‘ äº‹å‰æ‰“ã¡åˆã‚ã›ã¯ã€åº—èˆ—ã¨ç›´æ¥é€£çµ¡ã‚’å–ã£ã¦å®Ÿæ–½ã—ã¦ãã ã•ã„ã€‚
â‘¡ç´°èŒæ¤œæŸ»ã¯å¿…è¦ã‚ã‚Šã¾ã›ã‚“ã€‚
â‘¢æœ¬ãƒ¡ãƒ¼ãƒ«ã‚’ä»¥ã£ã¦å„æ ¡ã§ã”ç”¨æ„ã•ã‚Œã¦ã„ã‚‹æ›¸é¡ã¸ã®æ‰‹æ›¸ãè¨˜å…¥ä¾é ¼ã¯ã”é æ…®ãã ã•ã„ã€‚
ã€€å¹´é–“ã§å¤šãã®è·å ´ä½“é¨“ãƒ»åº—èˆ—è¦‹å­¦ã‚’å—å…¥ã‚Œã¦ãŠã‚Šã€å„æ ¡å€‹åˆ¥ã®å¯¾å¿œãŒã§ãã¾ã›ã‚“ã€‚
â‘£æ—¥ç¨‹ã®å¤‰æ›´ã€ã¾ãŸã¯ã‚­ãƒ£ãƒ³ã‚»ãƒ«ã™ã‚‹å ´åˆã®ã¿ã€åºƒå ±éƒ¨ï¼ˆå±±ç”°ï¼‰ã¾ã§ã”é€£çµ¡ä¸‹ã•ã„ã€‚

ã€å—å…¥å†…å®¹ã€‘
ä½“é¨“å†…å®¹ã€€ï¼š å•†å“æ•´ç†ã€ãƒ‡ã‚£ã‚¹ãƒ—ãƒ¬ã‚¤ã€å“å‡ºã—æº–å‚™(ãƒãƒ³ã‚¬ãƒ¼ã‹ã‘ç­‰)ã€å“å‡ºã—ã€æ¸…æƒã€POPä½œæˆ ä»–
ã€€ã€€ã€€ã€€ã€€ã€€ãã®ä»–åº—é•·åˆ¤æ–­ã§å¯èƒ½ãªä½œæ¥­ç­‰
è¡›ç”Ÿé–¢ä¿‚ã€€ï¼š é ­é«ªã¯ã€çµã¹ã‚‹é«ªã¯å¿…ãšçµã³ã€çˆªã¯çŸ­ãåˆ‡ã£ã¦ãã ã•ã„ã€‚
å‡ºå‹¤æ™‚æœè£…ï¼š å­¦æ ¡ã®åˆ¶æœ
ä½“é¨“ä¸­æœè£…ï¼š å­¦æ ¡ã®åˆ¶æœï¼ˆåº—é•·ã¨ç›¸è«‡ã®ä¸Šã€ç§æœã‚‚å¯ï¼‰
æŒã¡ç‰©ã€€ã€€ï¼š â‘ åæœ­ã€Œè·å ´ä½“é¨“å­¦ç¿’ä¸­ã€ã¨åˆ†ã‹ã‚‹ã‚‚ã®ã‚’ã”ç”¨æ„ãã ã•ã„ã€‚
ã€€ã€€ã€€ã€€ã€€ã€€    â€»å£²å ´ã«ã¯å¤šæ•°ã®ãŠå®¢æ§˜ãŒã„ã‚‰ã£ã—ã‚ƒã„ã¾ã™ã®ã§ã€å¾“æ¥­å“¡ã¨åŒºåˆ¥ã™ã‚‹ãŸã‚
ã€€ã€€ã€€ã€€ã€€ã€€â‘¡å¼å½“
ã€€ã€€ã€€ã€€ã€€ã€€    â€»ã‚µãƒŸãƒƒãƒˆã‚¹ãƒˆã‚¢ä½µè¨­åº—èˆ—ã®å ´åˆã¯å½“æ—¥è³¼å…¥ã§ã‚‚å¯
ã€€ã€€ã€€ã€€ã€€ã€€    â€»å¿…è¦æœ€å°é™ã®ç¾é‡‘ä»¥å¤–ã«è²´é‡å“ã¯æŒã£ã¦ã“ãªã„ã§ãã ã•ã„ã€‚
ãã®ä»–ã€€ã€€ ï¼š ã€ã„ã‚‰ã£ã—ã‚ƒã„ã¾ã›ã€ã€ã‚ã‚ŠãŒã¨ã†ã”ã–ã„ã¾ã™ã€ãŒå¤§ãã„å£°ã§è¨€ãˆã‚‹ã‚ˆã†ç·´ç¿’ã—ã¦ãŠã„ã¦ãã ã•ã„ã€‚

ã€ãã®ä»–ã€‘
â‘ æ’®å½±ã¯æ¬¡ã®æ¡ä»¶ä»˜ãã§å¯èƒ½ã§ã™ã€‚
ã€€ãƒ»ä»–ã®ãŠå®¢æ§˜ã‚’çµ¶å¯¾ã«æ˜ ã•ãªã„ã€€ãƒ»ãƒ•ãƒ©ãƒƒã‚·ãƒ¥ä¸å¯ã€€ãƒ»æˆæ¥­ã®ç¯„å›²å†…ã§ã®ä½¿ç”¨
â‘¡æ ¡å‰‡ã§èªã‚ã‚‰ã‚Œã¦ã„ã‚‹å ´åˆã‚’é™¤ãã€å…¬å…±äº¤é€šæ©Ÿé–¢ã§ãŠè¶Šã—ãã ã•ã„ã€‚
â‘¢ç”Ÿå¾’æ§˜ã®ä¸æ³¨æ„ã«ã‚ˆã‚‹ã‚±ã‚¬ã‚„äº‹æ•…ãŒç™ºç”Ÿã—ãŸéš›ã€å½“ç¤¾ã¯ä¸€åˆ‡ã®è²¬ä»»ã‚’è² ã„ã‹ã­ã¾ã™ã€‚
ã€€å¾¡æ ¡ã§åŠ å…¥ã•ã‚Œã¦ã„ã‚‹å­¦æ ¡ä¿é™ºç­‰ã§ã”å¯¾å¿œé¡˜ã„ã¾ã™ã€‚
`;

const T = {
  visit: {
    accept: {
      label: "å—å…¥å¯",
      type: "accept",
      subject: "{{S}} {{TT}}{{TN}} å…ˆç”Ÿã€€åº—èˆ—è¦‹å­¦å—å…¥ã‚Œã®ã”æ¡ˆå†…",
      greetings: [
        "ã“ã®ãŸã³ã¯ã€åº—èˆ—è¦‹å­¦ã‚’ãŠç”³ã—è¾¼ã¿ã„ãŸã ãã€èª ã«ã‚ã‚ŠãŒã¨ã†ã”ã–ã„ã¾ã™ã€‚",
        "åº—é•·ã¨æ‰“ã¡åˆã‚ã›ãŸçµæœã€ä»¥ä¸‹ã®å†…å®¹ã§ã”å—å…¥ã‚Œã§ãã‚‹é‹ã³ã¨ãªã‚Šã¾ã—ãŸã€‚"
      ],
      key: "stores_visit",
      color: "#4caf50",
      statusClass: "status-accepted"
    },
    proposal: {
      label: "å—å…¥ä¸å¯ï¼ˆææ¡ˆï¼‰",
      type: "proposal",
      subject: "{{S}} {{TT}}{{TN}} å…ˆç”Ÿã€€åº—èˆ—è¦‹å­¦æ—¥ç¨‹å†ææ¡ˆã®ã”æ¡ˆå†…",
      greetings: [
        "ã“ã®ãŸã³ã¯ã€åº—èˆ—è¦‹å­¦ã‚’ãŠç”³ã—è¾¼ã¿ã„ãŸã ãã€èª ã«ã‚ã‚ŠãŒã¨ã†ã”ã–ã„ã¾ã™ã€‚",
        "å¤§å¤‰ç”³ã—è¨³ã”ã–ã„ã¾ã›ã‚“ãŒã€ã”å¸Œæœ›ã®æ—¥ç¨‹ã§ã¯èª¿æ•´ãŒã§ãã¾ã›ã‚“ã§ã—ãŸã€‚",
        "ç¾åœ¨ãŠå—ã‘ã§ãã‚‹æ—¥ç¨‹ã¯ä¸‹è¨˜ã®ã¨ãŠã‚Šã§ã™ã€‚"
      ],
      key: "proposals_visit",
      color: "#ff9800",
      statusClass: "status-proposal"
    },
    decline: {
      label: "ãŠæ–­ã‚Š",
      type: "decline",
      subject: "{{S}} {{TT}}{{TN}} å…ˆç”Ÿã€€åº—èˆ—è¦‹å­¦ã®ãŠç”³è¾¼ã¿ã«ã¤ã„ã¦",
      greetings: [
        "ã“ã®ãŸã³ã¯ã€åº—èˆ—è¦‹å­¦ã‚’ãŠç”³ã—è¾¼ã¿ã„ãŸã ãã€èª ã«ã‚ã‚ŠãŒã¨ã†ã”ã–ã„ã¾ã™ã€‚",
        "å¤§å¤‰ç”³ã—è¨³ã”ã–ã„ã¾ã›ã‚“ãŒã€ä»Šå›ã¯ãŠå—ã‘ã™ã‚‹ã“ã¨ãŒã§ãã¾ã›ã‚“ã€‚"
      ],
      color: "#f44336",
      statusClass: "status-declined"
    }
  },
  work: {
    acceptSM: {
      label: "å—å…¥å¯ï¼ˆSMï¼‰",
      type: "acceptW",
      subject: "{{S}} {{TT}}{{TN}} å…ˆç”Ÿã€€è·å ´ä½“é¨“å—å…¥ã‚Œï¼ˆSMï¼‰ã”æ¡ˆå†…",
      greetings: [
        "ã“ã®ãŸã³ã¯ã€è·å ´ä½“é¨“ã‚’ãŠç”³ã—è¾¼ã¿ã„ãŸã ãã€èª ã«ã‚ã‚ŠãŒã¨ã†ã”ã–ã„ã¾ã™ã€‚",
        "åº—é•·ã¨æ‰“ã¡åˆã‚ã›ãŸçµæœã€ä»¥ä¸‹ã®å†…å®¹ã§ã”å—å…¥ã‚Œã§ãã‚‹é‹ã³ã¨ãªã‚Šã¾ã—ãŸã€‚"
      ],
      key: "stores_sm",
      color: "#4caf50",
      statusClass: "status-accepted"
    },
    acceptColmo: {
      label: "å—å…¥å¯ï¼ˆã‚³ãƒ«ãƒ¢ï¼‰",
      type: "acceptW",
      subject: "{{S}} {{TT}}{{TN}} å…ˆç”Ÿã€€è·å ´ä½“é¨“å—å…¥ã‚Œï¼ˆã‚³ãƒ«ãƒ¢ï¼‰ã”æ¡ˆå†…",
      greetings: [
        "ã“ã®ãŸã³ã¯ã€è·å ´ä½“é¨“ã‚’ãŠç”³ã—è¾¼ã¿ã„ãŸã ãã€èª ã«ã‚ã‚ŠãŒã¨ã†ã”ã–ã„ã¾ã™ã€‚",
        "ã‚³ãƒ«ãƒ¢åº—é•·ã¨å”è­°ã®ã†ãˆã€ä»¥ä¸‹ã®å†…å®¹ã§ã”æ¡ˆå†…ç”³ã—ä¸Šã’ã¾ã™ã€‚"
      ],
      key: "stores_colmo",
      color: "#4caf50",
      statusClass: "status-accepted"
    },
    acceptSpecial: {
      label: "å—å…¥å¯ï¼ˆèº«éšœå­¦ç´šï¼‰",
      type: "acceptW",
      subject: "{{S}} {{TT}}{{TN}} å…ˆç”Ÿã€€è·å ´ä½“é¨“å—å…¥ã‚Œï¼ˆèº«éšœå­¦ç´šï¼‰ã”æ¡ˆå†…",
      greetings: [
        "ã“ã®ãŸã³ã¯ã€èº«éšœå­¦ç´šã®è·å ´ä½“é¨“ã‚’ãŠç”³ã—è¾¼ã¿ã„ãŸã ãã‚ã‚ŠãŒã¨ã†ã”ã–ã„ã¾ã™ã€‚",
        "åº—é•·ã¨å”è­°ã®çµæœã€ä»¥ä¸‹ã®æ—¥ç¨‹ã§ã”å¯¾å¿œå¯èƒ½ã§ã™ã€‚"
      ],
      key: "stores_special",
      color: "#4caf50",
      statusClass: "status-accepted"
    },
    acceptConditional: {
      label: "å—å…¥å¯ï¼ˆä¸€éƒ¨ä¸å¯ãƒ»æ¡ä»¶æœ‰ã‚Šï¼‰",
      type: "acceptW",
      subject: "{{S}} {{TT}}{{TN}} å…ˆç”Ÿã€€è·å ´ä½“é¨“ ä¸€éƒ¨æ¡ä»¶ä»˜ãã”æ¡ˆå†…",
      greetings: [
        "ã“ã®ãŸã³ã¯ã€è·å ´ä½“é¨“ã‚’ãŠç”³ã—è¾¼ã¿ã„ãŸã ãã€ã‚ã‚ŠãŒã¨ã†ã”ã–ã„ã¾ã™ã€‚",
        "ä¸€éƒ¨æ¡ä»¶ä»˜ãã§ã¯ã”ã–ã„ã¾ã™ãŒã€ä¸‹è¨˜ã®ã¨ãŠã‚Šã”æ¡ˆå†…ã„ãŸã—ã¾ã™ã€‚"
      ],
      key: "stores_conditional",
      color: "#ff9800",
      statusClass: "status-proposal"
    },
    decline: {
      label: "ãŠæ–­ã‚Š",
      type: "decline",
      subject: "{{S}} {{TT}}{{TN}} å…ˆç”Ÿã€€è·å ´ä½“é¨“ã®ãŠç”³è¾¼ã¿ã«ã¤ã„ã¦",
      greetings: [
        "ã“ã®ãŸã³ã¯ã€è·å ´ä½“é¨“ã‚’ãŠç”³ã—è¾¼ã¿ã„ãŸã ãã€èª ã«ã‚ã‚ŠãŒã¨ã†ã”ã–ã„ã¾ã™ã€‚",
        "å¤§å¤‰ç”³ã—è¨³ã”ã–ã„ã¾ã›ã‚“ãŒã€ä»Šå›ã¯ãŠå—ã‘ã™ã‚‹ã“ã¨ãŒã§ãã¾ã›ã‚“ã€‚"
      ],
      color: "#f44336",
      statusClass: "status-declined"
    }
  }
};

const emptyStore = { name:"", date:"", time:"", count:"", manager:"", tel:"" };
const emptyProp  = { date:"", time:"", condition:"" };
const demoStores = [
  {name:"æ¡œãƒ¶ä¸˜åº—",date:"7/3(æ°´)",time:"10:00",count:"4",manager:"éˆ´æœ¨",tel:"03-1111-2222"},
  {name:"ç·´é¦¬åº—",  date:"7/4(æœ¨)",time:"11:00",count:"3",manager:"ä½è—¤",tel:"03-3333-4444"}
];
const demoProps = [
  {date:"7/10(æ°´)",time:"10:00",condition:"åˆå‰ã®ã¿"},
  {date:"7/11(æœ¨)",time:"14:00",condition:"åˆå¾Œã®ã¿"}
];

function ApplicantStatusView({ f, tpl }) {
  const subject = tpl.subject
    .replace("{{S}}", f.school)
    .replace("{{TT}}", f.title)
    .replace("{{TN}}", f.teacher);

  const items = tpl.type.startsWith("accept")
    ? f[tpl.key]
    : tpl.type === "proposal"
      ? f[tpl.key]
      : [];

  return (
    <div className="form-section">
      <div className="section-header">
        <Typography variant="h5" sx={{ fontWeight: 500, display: 'flex', alignItems: 'center' }}>
          <span className="material-icons" style={{ marginRight: 8 }}>assignment</span>
          ç”³è¾¼çµæœã®ã”ç¢ºèª
        </Typography>
      </div>
      
      <CardContent sx={{ p: 3 }}>
        {/* çµæœã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ */}
        <Box sx={{ mb: 4, p: 3, borderRadius: 2 }} className={tpl.statusClass}>
          <Box sx={{ display: 'flex', alignItems: 'center', mb: 2 }}>
            <span className="material-icons" style={{ 
              fontSize: 32, 
              marginRight: 12, 
              color: tpl.color 
            }}>
              {tpl.type === 'decline' ? 'cancel' : tpl.type === 'proposal' ? 'schedule' : 'check_circle'}
            </span>
            <Typography variant="h4" sx={{ fontWeight: 600, color: tpl.color }}>
              {tpl.label}
            </Typography>
          </Box>
          
          {tpl.type === 'decline' && (
            <Alert severity="error" sx={{ mb: 2 }}>
              <Typography variant="h6" sx={{ fontWeight: 600, mb: 1 }}>
                ç”³ã—è¨³ã”ã–ã„ã¾ã›ã‚“
              </Typography>
              <Typography>
                ä»Šå›ã¯ãŠå—ã‘ã™ã‚‹ã“ã¨ãŒã§ãã¾ã›ã‚“ã§ã—ãŸã€‚
                {f.reason && `ç†ç”±ï¼š${f.reason}`}
              </Typography>
            </Alert>
          )}
          
          {tpl.type === 'proposal' && (
            <Alert severity="warning" sx={{ mb: 2 }}>
              <Typography variant="h6" sx={{ fontWeight: 600, mb: 1 }}>
                æ—¥ç¨‹ã®å†èª¿æ•´ã‚’ãŠé¡˜ã„ã—ã¾ã™
              </Typography>
              <Typography>
                ã”å¸Œæœ›ã®æ—¥ç¨‹ã§ã¯èª¿æ•´ãŒã§ãã¾ã›ã‚“ã§ã—ãŸã€‚ä¸‹è¨˜ã®å€™è£œæ—¥ç¨‹ã‚’ã”ç¢ºèªãã ã•ã„ã€‚
              </Typography>
            </Alert>
          )}
          
          {tpl.type.startsWith('accept') && (
            <Alert severity="success" sx={{ mb: 2 }}>
              <Typography variant="h6" sx={{ fontWeight: 600, mb: 1 }}>
                å—å…¥ãŒæ±ºå®šã„ãŸã—ã¾ã—ãŸ
              </Typography>
              <Typography>
                ä»¥ä¸‹ã®å†…å®¹ã§æº–å‚™ã„ãŸã—ã¾ã™ã€‚è©³ç´°ã¯å„åº—èˆ—ã¸ç›´æ¥ãŠå•ã„åˆã‚ã›ãã ã•ã„ã€‚
              </Typography>
            </Alert>
          )}
        </Box>

        {/* ç”³è¾¼æƒ…å ±ã‚µãƒãƒªãƒ¼ */}
        <Box sx={{ mb: 3, p: 2, backgroundColor: '#f8f9fa', borderRadius: 2 }}>
          <Typography variant="h6" sx={{ fontWeight: 600, mb: 2 }}>
            ğŸ“‹ ç”³è¾¼æƒ…å ±
          </Typography>
          <Grid container spacing={2}>
            <Grid item xs={12} sm={6}>
              <Typography variant="body2" color="text.secondary">å­¦æ ¡å</Typography>
              <Typography variant="body1" sx={{ fontWeight: 500 }}>{f.school}</Typography>
            </Grid>
            <Grid item xs={12} sm={6}>
              <Typography variant="body2" color="text.secondary">æ‹…å½“è€…</Typography>
              <Typography variant="body1" sx={{ fontWeight: 500 }}>{f.title}{f.teacher} å…ˆç”Ÿ</Typography>
            </Grid>
            <Grid item xs={12} sm={6}>
              <Typography variant="body2" color="text.secondary">ç”³è¾¼åŒºåˆ†</Typography>
              <Chip 
                label={f.applicationCategory === 'visit' ? 'åº—èˆ—è¦‹å­¦' : 'è·å ´ä½“é¨“'}
                size="small"
                color="primary"
              />
            </Grid>
            <Grid item xs={12} sm={6}>
              <Typography variant="body2" color="text.secondary">å›ç­”æ—¥</Typography>
              <Typography variant="body1" sx={{ fontWeight: 500 }}>{f.sendDate}</Typography>
            </Grid>
          </Grid>
        </Box>

        {/* å—å…¥è©³ç´° */}
        {tpl.type.startsWith("accept") && items.length > 0 && (
          <Box sx={{ mb: 3 }}>
            <Typography variant="h6" sx={{ fontWeight: 600, mb: 2, color: '#4a148c' }}>
              ğŸª å—å…¥åº—èˆ—ãƒ»æ—¥ç¨‹è©³ç´°
            </Typography>
            {items.map((s, i) => (
              <Paper key={i} sx={{ p: 3, mb: 2, border: '2px solid #4caf50', borderRadius: 2 }}>
                <Typography variant="h6" sx={{ fontWeight: 600, mb: 2, color: '#2e7d32' }}>
                  {s.name}
                </Typography>
                <Grid container spacing={2}>
                  <Grid item xs={6} sm={3}>
                    <Typography variant="body2" color="text.secondary">å®Ÿæ–½æ—¥</Typography>
                    <Typography variant="h6" sx={{ fontWeight: 600, color: '#1976d2' }}>{s.date}</Typography>
                  </Grid>
                  <Grid item xs={6} sm={3}>
                    <Typography variant="body2" color="text.secondary">æ™‚é–“</Typography>
                    <Typography variant="h6" sx={{ fontWeight: 600, color: '#1976d2' }}>{s.time}</Typography>
                  </Grid>
                  <Grid item xs={6} sm={3}>
                    <Typography variant="body2" color="text.secondary">å—å…¥äººæ•°</Typography>
                    <Typography variant="h6" sx={{ fontWeight: 600, color: '#1976d2' }}>{s.count}å</Typography>
                  </Grid>
                  <Grid item xs={6} sm={3}>
                    <Typography variant="body2" color="text.secondary">åº—é•·</Typography>
                    <Typography variant="h6" sx={{ fontWeight: 600 }}>{s.manager}</Typography>
                  </Grid>
                  <Grid item xs={12}>
                    <Typography variant="body2" color="text.secondary">åº—èˆ—ç›´é€šé›»è©±</Typography>
                    <Typography variant="h5" sx={{ fontWeight: 600, color: '#d32f2f' }}>
                      ğŸ“ {s.tel}
                    </Typography>
                  </Grid>
                </Grid>
              </Paper>
            ))}
          </Box>
        )}

        {/* ææ¡ˆæ—¥ç¨‹ */}
        {tpl.type === "proposal" && items.length > 0 && (
          <Box sx={{ mb: 3 }}>
            <Typography variant="h6" sx={{ fontWeight: 600, mb: 2, color: '#f57f17' }}>
              ğŸ“… å€™è£œæ—¥ç¨‹
            </Typography>
            {items.map((p, i) => (
              <Paper key={i} sx={{ p: 2, mb: 1, border: '2px solid #ff9800', borderRadius: 2 }}>
                <Typography variant="h6" sx={{ fontWeight: 500 }}>
                  {p.date} {p.time} {p.condition && `ï¼ˆ${p.condition}ï¼‰`}
                </Typography>
              </Paper>
            ))}
            <Alert severity="info" sx={{ mt: 2 }}>
              ä¸Šè¨˜å€™è£œæ—¥ç¨‹ã§ã”éƒ½åˆã®ã¤ãæ—¥ãŒã”ã–ã„ã¾ã—ãŸã‚‰ã€åºƒå ±éƒ¨ã¾ã§ã”é€£çµ¡ãã ã•ã„ã€‚
            </Alert>
          </Box>
        )}

        {/* é‡è¦ãªé€£çµ¡äº‹é … */}
        {tpl.type.startsWith("accept") && (
          <Alert severity="info" sx={{ mb: 3 }}>
            <Typography variant="h6" sx={{ fontWeight: 600, mb: 1 }}>
              âš ï¸ é‡è¦ï¼šä»Šå¾Œã®ãŠæ‰‹ç¶šãã«ã¤ã„ã¦
            </Typography>
            <Typography>
              â€¢ äº‹å‰æ‰“ã¡åˆã‚ã›ã¯ã€å„åº—èˆ—ã¨ç›´æ¥ã”é€£çµ¡ã‚’ãŠå–ã‚Šãã ã•ã„<br/>
              â€¢ æ—¥ç¨‹å¤‰æ›´ãƒ»ã‚­ãƒ£ãƒ³ã‚»ãƒ«ã®å ´åˆã®ã¿ã€åºƒå ±éƒ¨ï¼ˆ{f.sender}ï¼‰ã¾ã§ã”é€£çµ¡ãã ã•ã„<br/>
              â€¢ ãã®ä»–ã”ä¸æ˜ãªç‚¹ã¯ã€å„åº—èˆ—ã¾ã§ç›´æ¥ãŠå•ã„åˆã‚ã›ãã ã•ã„
            </Typography>
          </Alert>
        )}

        {/* å‚™è€ƒ */}
        {f.comment && (
          <Box sx={{ mt: 3, p: 2, backgroundColor: '#fff8e1', borderRadius: 2, border: '1px solid #ffcc02' }}>
            <Typography variant="subtitle1" sx={{ fontWeight: 600, mb: 1, color: '#f57f17' }}>
              ğŸ’¬ è£œè¶³äº‹é …
            </Typography>
            <Typography>{f.comment}</Typography>
          </Box>
        )}
      </CardContent>
    </div>
  );
}

function ReplyPreview({ f, tpl, isApplicantView }) {
  if (isApplicantView) {
    return <ApplicantStatusView f={f} tpl={tpl} />;
  }

  const subject = tpl.subject
    .replace("{{S}}", f.school)
    .replace("{{TT}}", f.title)
    .replace("{{TN}}", f.teacher);

  const items = tpl.type.startsWith("accept")
    ? f[tpl.key]
    : tpl.type === "proposal"
      ? f[tpl.key]
      : [];

  return (
    <div className="form-section print-layout">
      {/* å°åˆ·ç”¨ãƒ˜ãƒƒãƒ€ãƒ¼ */}
      <div className="print-header" style={{ display: 'none' }}>
        <Typography variant="h4" sx={{ fontWeight: 'bold', mb: 1 }}>
          ç”³è¾¼çµæœé€šçŸ¥æ›¸ï¼ˆFAXé€ä¿¡ç”¨ï¼‰
        </Typography>
        <Typography variant="h6">
          é€ä¿¡æ—¥ï¼š{f.sendDate} / é€ä¿¡è€…ï¼š{f.sender}
        </Typography>
      </div>

      <div className="section-header">
        <Typography variant="h5" sx={{ fontWeight: 500, display: 'flex', alignItems: 'center' }}>
          <span className="material-icons" style={{ marginRight: 8 }}>preview</span>
          ã”è¿”ä¿¡å†…å®¹ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼
        </Typography>
      </div>
      
      <CardContent sx={{ p: 3 }} className="print-content">
        {/* ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ãƒãƒƒãƒ— */}
        <Box sx={{ mb: 3 }}>
          <Chip 
            label={tpl.label} 
            sx={{ 
              backgroundColor: tpl.color, 
              color: 'white', 
              fontWeight: 'bold',
              fontSize: '0.9rem',
              px: 1
            }} 
          />
        </Box>

        {/* åŸºæœ¬æƒ…å ±ï¼ˆå°åˆ·ç”¨ãƒ†ãƒ¼ãƒ–ãƒ«ï¼‰ */}
        <div className="print-section">
          <table className="print-table" style={{ display: 'none' }}>
            <tbody>
              <tr>
                <th>å­¦æ ¡å</th>
                <td>{f.school}</td>
                <th>æ‹…å½“è€…</th>
                <td>{f.title}{f.teacher} å…ˆç”Ÿ</td>
              </tr>
              <tr>
                <th>ç”³è¾¼åŒºåˆ†</th>
                <td>{f.applicationCategory === 'visit' ? 'åº—èˆ—è¦‹å­¦' : 'è·å ´ä½“é¨“'}</td>
                <th>å›ç­”è€…</th>
                <td>{f.sender}</td>
              </tr>
              <tr>
                <th>ä»¶å</th>
                <td colSpan="3">{subject}</td>
              </tr>
            </tbody>
          </table>
        </div>

        {/* åŸºæœ¬æƒ…å ±ã‚°ãƒªãƒƒãƒ‰ï¼ˆç”»é¢è¡¨ç¤ºç”¨ï¼‰ */}
        <Grid container spacing={3} sx={{ mb: 3 }} className="no-print">
          {[
            { label: "å­¦æ ¡å", value: f.school, icon: "school" },
            { label: "å…ˆç”Ÿ", value: `${f.title}${f.teacher}`, icon: "person" },
            { label: "ç¤¾å†…æ‹…å½“è€…", value: f.sender, icon: "business" },
            { label: "é€ä¿¡æ—¥", value: f.sendDate, icon: "today" }
          ].map((item, i) => (
            <Grid item xs={12} sm={6} key={i}>
              <Paper sx={{ p: 2, background: 'linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%)' }}>
                <Box sx={{ display: 'flex', alignItems: 'center', mb: 1 }}>
                  <span className="material-icons" style={{ fontSize: 18, marginRight: 8, color: '#666' }}>
                    {item.icon}
                  </span>
                  <Typography variant="caption" color="text.secondary" sx={{ fontWeight: 500 }}>
                    {item.label}
                  </Typography>
                </Box>
                <Typography variant="body1" sx={{ fontWeight: 500 }}>
                  {item.value}
                </Typography>
              </Paper>
            </Grid>
          ))}
        </Grid>

        <Divider sx={{ my: 3 }} />

        {/* ä»¶å */}
        <div className="print-section">
          <Box sx={{ mb: 3, p: 2, backgroundColor: '#f5f5f5', borderRadius: 2 }}>
            <Typography variant="h6" sx={{ fontWeight: 600, color: '#1976d2' }}>
              ğŸ“§ ä»¶åï¼š{subject}
            </Typography>
          </Box>
        </div>

        {/* ã‚ã„ã•ã¤æ–‡ */}
        <div className="print-section">
          <Box sx={{ mb: 3 }}>
            {tpl.greetings.map((g, i) => (
              <Typography key={i} paragraph sx={{ lineHeight: 1.8 }}>
                {g}
              </Typography>
            ))}
          </Box>
        </div>

        {/* å—å…¥æƒ…å ± */}
        {tpl.type.startsWith("accept") && items.length > 0 && (
          <div className="print-section">
            <Typography variant="h6" sx={{ fontWeight: 600, mb: 2 }}>
              ã€å—å…¥åº—èˆ—ãƒ»æ—¥ç¨‹ã€‘
            </Typography>
            
            {/* å°åˆ·ç”¨ãƒ†ãƒ¼ãƒ–ãƒ« */}
            <table className="print-table" style={{ display: 'none' }}>
              <thead>
                <tr>
                  <th>åº—èˆ—å</th>
                  <th>å®Ÿæ–½æ—¥</th>
                  <th>æ™‚é–“</th>
                  <th>äººæ•°</th>
                  <th>åº—é•·</th>
                  <th>é›»è©±ç•ªå·</th>
                </tr>
              </thead>
              <tbody>
                {items.map((s, i) => (
                  <tr key={i}>
                    <td>{s.name}</td>
                    <td>{s.date}</td>
                    <td>{s.time}</td>
                    <td>{s.count}å</td>
                    <td>{s.manager}</td>
                    <td>{s.tel}</td>
                  </tr>
                ))}
              </tbody>
            </table>
            
            {/* ç”»é¢è¡¨ç¤ºç”¨ */}
            <div className="no-print">
              {items.map((s, i) => (
                <div key={i} className="store-item">
                  <Typography variant="h6" sx={{ fontWeight: 600, mb: 1, color: '#4a148c' }}>
                    ğŸª {s.name}
                  </Typography>
                  <Grid container spacing={2}>
                    <Grid item xs={6} sm={3}>
                      <Typography variant="body2" color="text.secondary">æ—¥ç¨‹</Typography>
                      <Typography variant="body1" sx={{ fontWeight: 500 }}>{s.date}</Typography>
                    </Grid>
                    <Grid item xs={6} sm={3}>
                      <Typography variant="body2" color="text.secondary">æ™‚é–“</Typography>
                      <Typography variant="body1" sx={{ fontWeight: 500 }}>{s.time}</Typography>
                    </Grid>
                    <Grid item xs={6} sm={3}>
                      <Typography variant="body2" color="text.secondary">äººæ•°</Typography>
                      <Typography variant="body1" sx={{ fontWeight: 500 }}>{s.count}å</Typography>
                    </Grid>
                    <Grid item xs={6} sm={3}>
                      <Typography variant="body2" color="text.secondary">åº—é•·</Typography>
                      <Typography variant="body1" sx={{ fontWeight: 500 }}>{s.manager}</Typography>
                    </Grid>
                    <Grid item xs={12}>
                      <Typography variant="body2" color="text.secondary">TEL</Typography>
                      <Typography variant="body1" sx={{ fontWeight: 500 }}>{s.tel}</Typography>
                    </Grid>
                  </Grid>
                </div>
              ))}
            </div>
          </div>
        )}

        {/* ææ¡ˆæƒ…å ± */}
        {tpl.type === "proposal" && items.length > 0 && (
          <div className="print-section">
            <Typography variant="h6" sx={{ fontWeight: 600, mb: 2 }}>
              ã€å€™è£œæ—¥ç¨‹ã€‘
            </Typography>
            
            {/* å°åˆ·ç”¨ãƒ†ãƒ¼ãƒ–ãƒ« */}
            <table className="print-table" style={{ display: 'none' }}>
              <thead>
                <tr>
                  <th>å€™è£œæ—¥</th>
                  <th>æ™‚é–“</th>
                  <th>æ¡ä»¶</th>
                </tr>
              </thead>
              <tbody>
                {items.map((p, i) => (
                  <tr key={i}>
                    <td>{p.date}</td>
                    <td>{p.time}</td>
                    <td>{p.condition}</td>
                  </tr>
                ))}
              </tbody>
            </table>
            
            {/* ç”»é¢è¡¨ç¤ºç”¨ */}
            <div className="no-print">
              {items.map((p, i) => (
                <div key={i} className="proposal-item">
                  <Typography variant="body1" sx={{ fontWeight: 500 }}>
                    ğŸ“… {p.date} {p.time} {p.condition}
                  </Typography>
                </div>
              ))}
            </div>
          </div>
        )}

        {/* ãŠæ–­ã‚Šç†ç”± */}
        {tpl.type === "decline" && f.reason && (
          <div className="print-section">
            <Alert severity="info" sx={{ mb: 2 }}>
              <Typography><strong>ç†ç”±ï¼š</strong>{f.reason}</Typography>
            </Alert>
          </div>
        )}

        {/* è·å ´ä½“é¨“å…±é€šæ¡ˆå†… */}
        {tpl.type === "acceptW" && (
          <div className="print-section">
            <Box sx={{ mt: 3, p: 2, backgroundColor: '#f0f7ff', borderRadius: 2, border: '1px solid #bbdefb' }}>
              <Typography variant="subtitle1" sx={{ fontWeight: 600, mb: 2, color: '#1565c0' }}>
                ğŸ“‹ å…±é€šæ¡ˆå†…äº‹é …
              </Typography>
              <Typography component="pre" sx={{ 
                whiteSpace: 'pre-line', 
                fontSize: '0.875rem',
                lineHeight: 1.6,
                fontFamily: 'inherit'
              }}>
                {COMMON_WORK_NOTICE.trim()}
              </Typography>
            </Box>
          </div>
        )}

        {/* è‡ªç”±å‚™è€ƒ */}
        {f.comment && (
          <div className="print-section">
            <Box sx={{ mt: 3, p: 2, backgroundColor: '#fff8e1', borderRadius: 2, border: '1px solid #ffcc02' }}>
              <Typography variant="subtitle1" sx={{ fontWeight: 600, mb: 1, color: '#f57f17' }}>
                ğŸ’¬ å‚™è€ƒ
              </Typography>
              <Typography>{f.comment}</Typography>
            </Box>
          </div>
        )}
      </CardContent>
    </div>
  );
}

function App() {
  const [cat, setCat] = React.useState("visit");
  const [pat, setPat] = React.useState("accept");
  const [isApplicantView, setIsApplicantView] = React.useState(false);
  const [f, setF] = React.useState({
    school: "â—â—å°å­¦æ ¡",
    title: "",
    teacher: "å±±ç”°",
    sender: "åºƒå ±éƒ¨ ç”°ä¸­",
    sendDate: "2025/05/23",
    comment: "",
    reason: "",
    applicationCategory: "visit",
    stores_visit: [...demoStores],
    proposals_visit: [...demoProps],
    stores_sm: [...demoStores],
    stores_colmo: [...demoStores],
    stores_special: [...demoStores],
    stores_conditional: [...demoStores]
  });

  const h = key => e => setF({ ...f, [key]: e.target.value });
  const tpl = T[cat][pat];

  // ã‚«ãƒ†ã‚´ãƒªå¤‰æ›´æ™‚ã«applicationCategoryã‚‚æ›´æ–°
  React.useEffect(() => {
    setF(prev => ({ ...prev, applicationCategory: cat }));
  }, [cat]);

  const handleViewSwitch = () => {
    setIsApplicantView(!isApplicantView);
  };

  const handlePrint = () => {
    // å°åˆ·æ™‚ã«å°åˆ·ç”¨ã‚¹ã‚¿ã‚¤ãƒ«ã‚’é©ç”¨
    const printElements = document.querySelectorAll('.print-table');
    printElements.forEach(el => {
      el.style.display = 'table';
    });
    
    const printHeader = document.querySelector('.print-header');
    if (printHeader) {
      printHeader.style.display = 'block';
    }
    
    window.print();
    
    // å°åˆ·å¾Œã«å…ƒã«æˆ»ã™
    setTimeout(() => {
      printElements.forEach(el => {
        el.style.display = 'none';
      });
      if (printHeader) {
        printHeader.style.display = 'none';
      }
    }, 1000);
  };

  return (
    <>
      <CssBaseline />

      {/* å›ºå®šãƒ˜ãƒƒãƒ€ãƒ¼ */}
      <AppBar position="static" className={`no-print sticky-header ${isApplicantView ? 'applicant-view' : 'admin-view'}`}>
        <Toolbar>
          <span className="material-icons" style={{ marginRight: 8 }}>
            {isApplicantView ? 'person' : 'admin_panel_settings'}
          </span>
          <Typography variant="h6" sx={{ flexGrow: 1, fontWeight: 600 }}>
            {isApplicantView ? 'ğŸ“‹ ç”³è¾¼çµæœç¢ºèªã‚·ã‚¹ãƒ†ãƒ ' : 'ğŸ“ è¿”ä¿¡ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆä½œæˆã‚·ã‚¹ãƒ†ãƒ '}
          </Typography>
          
          {/* è¡¨ç¤ºåˆ‡ã‚Šæ›ãˆã‚¹ã‚¤ãƒƒãƒ */}
          <FormControlLabel
            control={
              <Switch
                checked={isApplicantView}
                onChange={handleViewSwitch}
                color="default"
              />
            }
            label={
              <Box sx={{ display: 'flex', alignItems: 'center', color: 'white' }}>
                <span className="material-icons" style={{ fontSize: 18, marginRight: 4 }}>
                  {isApplicantView ? 'person' : 'admin_panel_settings'}
                </span>
                {isApplicantView ? 'ç”³è¾¼è€…' : 'ç®¡ç†è€…'}
              </Box>
            }
            sx={{ mr: 2, color: 'white' }}
          />
          
          <Button 
            color="inherit" 
            onClick={handlePrint}
            startIcon={<span className="material-icons">print</span>}
            sx={{ fontWeight: 500 }}
          >
            {isApplicantView ? 'çµæœå°åˆ·' : 'FAXå°åˆ·'}
          </Button>
        </Toolbar>
      </AppBar>

      <Container maxWidth="lg" sx={{ mt: 3, mb: 4 }}>
        {/* ç®¡ç†è€…ç”¨è¨­å®šãƒ‘ãƒãƒ« */}
        {!isApplicantView && (
          <div className="form-section no-print">
            <div className="section-header">
              <Typography variant="h6" sx={{ fontWeight: 500 }}>
                âš™ï¸ åŸºæœ¬è¨­å®š
              </Typography>
            </div>
            <CardContent>
              <Grid container spacing={3}>
                <Grid item xs={12} sm={6}>
                  <FormControl fullWidth variant="outlined">
                    <InputLabel>ç”³è¾¼åŒºåˆ†</InputLabel>
                    <Select
                      value={cat}
                      label="ç”³è¾¼åŒºåˆ†"
                      onChange={e => {
                        setCat(e.target.value);
                        setPat(Object.keys(T[e.target.value])[0]);
                      }}
                    >
                      <MenuItem value="visit">ğŸª åº—èˆ—è¦‹å­¦</MenuItem>
                      <MenuItem value="work">ğŸ’¼ è·å ´ä½“é¨“</MenuItem>
                    </Select>
                  </FormControl>
                </Grid>
                <Grid item xs={12} sm={6}>
                  <FormControl fullWidth variant="outlined">
                    <InputLabel>å—å…¥ãƒ‘ã‚¿ãƒ¼ãƒ³</InputLabel>
                    <Select value={pat} label="å—å…¥ãƒ‘ã‚¿ãƒ¼ãƒ³" onChange={e => setPat(e.target.value)}>
                      {Object.entries(T[cat]).map(([k, v]) => (
                        <MenuItem key={k} value={k}>
                          <Chip 
                            size="small" 
                            label={v.label} 
                            sx={{ 
                              backgroundColor: v.color, 
                              color: 'white', 
                              mr: 1,
                              fontSize: '0.75rem'
                            }} 
                          />
                        </MenuItem>
                      ))}
                    </Select>
                  </FormControl>
                </Grid>
              </Grid>
            </CardContent>
          </div>
        )}

        {/* ç”³è¾¼è€…ç”¨ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹è¡¨ç¤º */}
        {isApplicantView && (
          <Alert severity="info" sx={{ mb: 3 }} className="no-print">
            <Typography variant="h6" sx={{ fontWeight: 600, mb: 1 }}>
              ğŸ‘‹ {f.school} {f.title}{f.teacher} å…ˆç”Ÿ
            </Typography>
            <Typography>
              ç”³è¾¼ã„ãŸã ã„ãŸ{cat === 'visit' ? 'åº—èˆ—è¦‹å­¦' : 'è·å ´ä½“é¨“'}ã®çµæœã‚’ã”ç¢ºèªã„ãŸã ã‘ã¾ã™ã€‚
              å†…å®¹ã‚’ã”ç¢ºèªã®ä¸Šã€ã”ä¸æ˜ãªç‚¹ãŒã”ã–ã„ã¾ã—ãŸã‚‰ãŠæ°—è»½ã«ãŠå•ã„åˆã‚ã›ãã ã•ã„ã€‚
            </Typography>
          </Alert>
        )}

        {/* ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ã‚¨ãƒªã‚¢ */}
        <ReplyPreview f={f} tpl={tpl} isApplicantView={isApplicantView} />

        {/* ç®¡ç†è€…ç”¨ç·¨é›†ãƒ•ã‚©ãƒ¼ãƒ  */}
        {!isApplicantView && (
          <div className="form-section no-print">
            <div className="section-header">
              <Typography variant="h6" sx={{ fontWeight: 500 }}>
                âœï¸ è©³ç´°ç·¨é›†
              </Typography>
            </div>
            <CardContent>
              <Grid container spacing={3}>
                <Grid item xs={12} sm={6}>
                  <TextField
                    fullWidth
                    label="å­¦æ ¡å"
                    value={f.school}
                    onChange={h("school")}
                    variant="outlined"
                  />
                </Grid>
                <Grid item xs={12} sm={6}>
                  <TextField
                    fullWidth
                    label="å…ˆç”Ÿã®ãŠåå‰"
                    value={f.teacher}
                    onChange={h("teacher")}
                    variant="outlined"
                  />
                </Grid>
                <Grid item xs={12} sm={6}>
                  <TextField
                    fullWidth
                    label="æ•¬ç§°"
                    value={f.title}
                    onChange={h("title")}
                    variant="outlined"
                    placeholder="ä¾‹ï¼šæ ¡é•·ã€æ•™é ­ã€ä¸»ä»»"
                  />
                </Grid>
                <Grid item xs={12} sm={6}>
                  <TextField
                    fullWidth
                    label="ç¤¾å†…æ‹…å½“è€…"
                    value={f.sender}
                    onChange={h("sender")}
                    variant="outlined"
                  />
                </Grid>
                <Grid item xs={12}>
                  <TextField
                    fullWidth
                    label="è‡ªç”±å‚™è€ƒ"
                    multiline
                    rows={3}
                    value={f.comment}
                    onChange={h("comment")}
                    variant="outlined"
                    placeholder="è¿½åŠ ã§ä¼ãˆãŸã„å†…å®¹ãŒã‚ã‚Œã°è¨˜å…¥ã—ã¦ãã ã•ã„"
                  />
                </Grid>
                {tpl.type === "decline" && (
                  <Grid item xs={12}>
                    <TextField
                      fullWidth
                      label="ãŠæ–­ã‚Šç†ç”±"
                      multiline
                      rows={2}
                      value={f.reason}
                      onChange={h("reason")}
                      variant="outlined"
                      placeholder="ãŠæ–­ã‚Šã™ã‚‹ç†ç”±ã‚’è¨˜å…¥ã—ã¦ãã ã•ã„"
                    />
                  </Grid>
                )}
              </Grid>
            </CardContent>
          </div>
        )}
      </Container>

      {/* ãƒ•ãƒ­ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ãƒœã‚¿ãƒ³ */}
      <div className="floating-actions no-print">
        <Tooltip title={isApplicantView ? "ç”³è¾¼è€…ç”»é¢ã¨ç®¡ç†è€…ç”»é¢ã‚’åˆ‡ã‚Šæ›¿ãˆ" : "ç”³è¾¼è€…ç”»é¢ã‚’ç¢ºèª"}>
          <Fab 
            color="secondary" 
            onClick={handleViewSwitch}
            className="action-button"
          >
            <span className="material-icons">
              {isApplicantView ? 'admin_panel_settings' : 'person'}
            </span>
          </Fab>
        </Tooltip>
        
        <Tooltip title={isApplicantView ? "çµæœã‚’å°åˆ·" : "FAXç”¨ã«å°åˆ·"}>
          <Fab 
            color="primary" 
            onClick={handlePrint}
            className="action-button"
            size="large"
          >
            <span className="material-icons">print</span>
          </Fab>
        </Tooltip>
      </div>
    </>
  );
}

ReactDOM.render(<App />, document.getElementById("root"));
</script>
</body>
</html>